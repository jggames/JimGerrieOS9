PROCEDURE PegSHELL "tmode -echo -pause" RUN GFX2("DEFCOL")RUN GFX2("CURON")RUN GFX2("COLOR",0,2)RUN GFX2("CLEAR")BASE 030 DIM A,B,C,F,R,W,Z,DD,YO1,XO1,YS1,XS1,ZYC1,ZXC1,ZXS1,ZYS1,XC1,YC1,X,Y,XLIN,XPOS:INTEGERDIM KP$,MOVE$,P$,H$,CT$:STRING[1]GOSUB 161040 P$="o" \H$=" "50 DIM BB(71),Matrix(10,10),XY(10,10):INTEGER60 RUN GFX2("CLEAR") \XLIN=1 \XPOS=1 \ FOR R=1 TO 9 \ FOR C=1 TO 970 IF (R-4)*(R-5)*(R-6)=0 THEN 10080 IF (C-4)*(C-5)*(C-6)=0 THEN 10090 Matrix(R,C)=-5 \ GOTO 120100 IF (R-1)*(C-1)*(R-9)*(C-9)=0 THEN 90110 Matrix(R,C)=5 \ READ XY(R,C)120 NEXT CNEXT RMatrix(5,5)=0130 RUN GFX2("COLOR",0,2) \ PRINT 140 PRINT TAB(32); "+---+ +---+ +---+"150 PRINT TAB(32); "| o | | o | | o |"160 PRINT TAB(32); "+---+ +---+ +---+"170 PRINT TAB(32); "+---+ +---+ +---+"180 PRINT TAB(32); "| o | | o | | o |"190 PRINT TAB(32); "+---+ +---+ +---+"200 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"210 PRINT TAB(20); "| o | | o | | o | | o | | o | | o | | o |"220 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"230 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"240 PRINT TAB(20); "| o | | o | | o | |   | | o | | o | | o |"250 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"260 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"270 PRINT TAB(20); "| o | | o | | o | | o | | o | | o | | o |"280 PRINT TAB(20); "+---+ +---+ +---+ +---+ +---+ +---+ +---+"290 PRINT TAB(32); "+---+ +---+ +---+"300 PRINT TAB(32); "| o | | o | | o |"310 PRINT TAB(32); "+---+ +---+ +---+"320 PRINT TAB(32); "+---+ +---+ +---+"330 PRINT TAB(32); "| o | | o | | o |"340 PRINT TAB(32); "+---+ +---+ +---+"350 RESTORE  \ FOR W=1 TO 33 \ READ M \BB(M)=-7 \NEXT W \BB(41)= -3360 DATA 13,14,15,22,23,24,29,30,31,32,33,34,35,38,39,40,41370 DATA 42,43,44,47,48,49,50,51,52,53,58,59,60,67,68,69380 YS1=12 \XS1=40390 RUN GFX2("COLOR",7,2) \ GOSUB 1900400 RUN LOCATE(23,30) \ PRINT "  Move Which Piece?   "; 410 RUN LOCATE(YS1,XS1)420 GOTO 680430 RUN INKEY(MOVE$)IF MOVE$="" THEN 430450 IF MOVE$=CHR$(12) THEN GOSUB 520ENDIF 460 IF MOVE$=CHR$(8) THEN GOSUB 560ENDIF 470 IF MOVE$=CHR$(9) THEN GOSUB 600ENDIF 480 IF MOVE$=CHR$(10) THEN GOSUB 640ENDIF IF MOVE$="Q" OR MOVE$="q" THEN GOSUB 1850ENDIF 490 IF MOVE$<>CHR$(13) THEN 430500 XC1=(XS1-10)/6510 YC1=YS1/3+1 \ RETURN 520 IF YS1<6 THEN 550530 IF YS1<12 AND (XS1<34 OR XS1>46) THEN 550YS1=YS1-3540 RUN LOCATE(YS1,XS1)550 RETURN 560 IF XS1<28 THEN 590570 IF (YS1<9 OR YS1>15) AND XS1<40 THEN 590XS1=XS1-6580 RUN LOCATE(YS1,XS1)590 RETURN 600 IF XS1>52 THEN 630610 IF (YS1<9 OR YS1>15) AND XS1>40 THEN 630XS1=XS1+6620 RUN LOCATE(YS1,XS1)630 RETURN 640 IF YS1>20 THEN 670650 IF YS1>12 AND (XS1<34 OR XS1>46) THEN 670YS1=YS1+3660 RUN LOCATE(YS1,XS1)670 RETURN 680 GOSUB 430690 ZYS1=YS1 \ZXS1=XS1 \ZYC1=YC1 \ZXC1=XC1 \Z=XY(YC1,XC1)700 IF BB(Z)=-7 THEN 800710 CT$=H$720 IF Matrix(ZYC1,ZXC1)=5 THEN CT$=P$ENDIF 730 RUN LOCATE(ZYS1,ZXS1) \ PRINT CT$; 740 CT$=H$750 IF Matrix(YC1,XC1)=5 THEN CT$=P$ENDIF 760 RUN LOCATE(YS1,XS1) \ PRINT CT$; 770 RUN LOCATE(20,1) \ PRINT "Illegal Move, Try Again..."; 780 FOR DD=1 TO 8000 \NEXT DD790 RUN LOCATE(20,1) \RUN SPC(27) \RUN LOCATE(YS1,XS1) \ GOTO 380800 RUN LOCATE(23,31) \ PRINT "     To Where?       "; 810 RUN LOCATE(YS1,XS1) \RUN GFX2("BLNKON") \ PRINT P$;  \RUN GFX2 ("COLOR",0,2)RUN GFX2("BLNKOFF")820 RUN LOCATE(YS1,XS1) \ GOSUB 430830 P=XY(YC1,XC1)840 IF BB(P)=0 OR BB(P)=-7 THEN 710850 IF Z=P THEN 380860 IF (Z+P)/2=INT((Z+P)/2) THEN GOTO 870ELSE GOTO 710ENDIF 870 IF (ABS(Z-P)-2)*(ABS(Z-P)-18)<>0 THEN 710880 GOSUB 1010 \ GOSUB 890 \ GOSUB 1200 \ GOTO 380890 CT$=H$900 IF Matrix(ZYC1,ZXC1)=5 THEN CT$=P$ENDIF 910 RUN LOCATE(ZYS1,ZXS1) \ PRINT CT$;  \CT$=H$920 IF Matrix(YC1,XC1)=5 THEN CT$=P$ENDIF 930 RUN LOCATE(YS1,XS1) \ PRINT CT$; 940 YO1=ZYC1-YC1 \XO1=ZXC1-XC1950 IF YO1>0 THEN YO1=1ENDIF 960 IF XO1>0 THEN XO1=1ENDIF 970 IF YO1<0 THEN YO1=-1ENDIF 980 IF XO1<0 THEN XO1=-1ENDIF 990 CT$=H$1000 RUN LOCATE(YS1+YO1*3,XS1+XO1*6) \ PRINT CT$;  \ RETURN 1010 C=1 \ FOR X=1 TO 9 \ FOR Y=1 TO 91020 IF C<>Z THEN 11801030 IF C+2<>P THEN 10701040 IF Matrix(X,Y+1)=0 THEN 7101050 Matrix(X,Y+2)=51060 Matrix(X,Y+1)=0 \BB(C+1)=-3 \ GOTO 11601070 IF C+18<>P THEN 11001080 IF Matrix(X+1,Y)=0 THEN 7101090 Matrix(X+2,Y)=5 \Matrix(X+1,Y)=0 \BB(C+9)=-3 \ GOTO 11601100 IF C-2<>P THEN 11301110 IF Matrix(X,Y-1)=0 THEN 7101120 Matrix(X,Y-2)=5 \Matrix(X,Y-1)=0 \BB(C-1)=-3 \ GOTO 11601130 IF C-18<>P THEN 11801140 IF Matrix(X-1,Y)=0 THEN 7101150 Matrix(X-2,Y)=5 \Matrix(X-1,Y)=0 \BB(C-9)=-3 \BB(Z)=-3 \BB( P)=-71160 BB(Z)=-3 \BB(P)=-71170 Matrix(X,Y)=0 \ RETURN 1180 C=C+11190 NEXT YNEXT XRETURN 1200 F=01210 FOR R=2 TO 8 \ FOR C=2 TO 81220 IF Matrix(R,C)<>5 THEN 13201230 F=F+11240 FOR A=R-1 TO R+1 \T=0 \ FOR B=C-1 TO C+1 \T=T+Matrix(A,B) \NEXT B1250 IF T<>10 THEN 12701260 IF Matrix(A,C)<>0 THEN 15901270 NEXT A1280 FOR X=C-1 TO C+1 \T=0 \ FOR Y=R-1 TO R+1 \T=T+Matrix(Y,X) \NEXT Y1290 IF T<>10 THEN 13101300 IF Matrix(R,X)<>0 THEN 15901310 NEXT X1320 NEXT C1330 NEXT R1340 RUN LOCATE(22,1) \ PRINT "Only "; F; " Pieces Remaining."1350 RUN LOCATE(24,1) \RUN SPC(79)1360 IF F<>1 THEN 14001370 RUN LOCATE(21,1) \ PRINT "BRAVO!"1380 RUN LOCATE(23,1) \ PRINT "A Perfect Score!"1390 IF Matrix(5,5)=5 THEN RUN LOCATE(23,1) \ PRINT "In The Center! You're A Genius!"ENDIF 1400 IF F<>2 THEN 14301410 RUN LOCATE(21,1) \ PRINT "EXCELLENT!"1420 RUN LOCATE(23,1) \ PRINT "Try Again."1430 IF F=3 OR F=4 THEN RUN LOCATE(21,1) \ PRINT "GREAT!"ENDIF 1440 IF F=3 OR F=4 THEN RUN LOCATE(23,1) \ PRINT "Don't Give Up Yet."ENDIF 1450 IF F>=5 AND F<=7 THEN RUN LOCATE(21,1) \ PRINT "NOT BAD."ENDIF 1460 IF F>=5 AND F<=7 THEN RUN LOCATE(23,1) \ PRINT "Give It Another Shot."ENDIF 1470 IF F<8 THEN 15401480 IF F>24 THEN 15201490 RUN LOCATE(21,1) \ PRINT "OUCH!"1500 RUN LOCATE(22,1) \ PRINT "You Had "; F; " Pieces Remaining."1510 RUN LOCATE(23,1) \ PRINT "Today Is Not Your Day!" \ GOTO 15401520 RUN LOCATE(21,1) \ PRINT "WRONG OBJECTIVE!"1530 RUN LOCATE(23,1) \ PRINT "When All Else Fails, Read The Instructions!"1540 RUN LOCATE(24,1) \ PRINT "Would You Like To Play Again? <Y/N> " ; 1550 RUN INKEY(KP$) \ IF KP$="" THEN 15501560 IF KP$="n" OR KP$="N" THEN 16001570 IF KP$<>"y" AND KP$<>"Y" THEN 15501580 RESTORE  \ GOTO 601590 RETURN 1600 SHELL "Tmode echo" \ END 1610 RUN GFX2("COLOR",2,6)1620 RUN LOCATE(1,1) \RUN SPC(80)1630 FOR A=2 TO 22 \RUN LOCATE(A,1) \ PRINT " " \RUN LOCATE(A,80 ) \ PRINT " " \NEXT A1640 RUN LOCATE(23,1) \RUN SPC(80)1650 RUN GFX2("COLOR",5,2) \RUN LOCATE(3,34) \RUN GFX2("BLNKON")  \ PRINT "P E G    L E A P"RUN GFX2("BLNKOFF")1660 RUN GFX2("COLOR",0,2) \RUN LOCATE(8,25) \ PRINT "Would You Like Instructions? <Y/N> " ;  \RUN GFX2("COLOR",7,2)1670 RUN INKEY(KP$) \ IF KP$="" THEN 16701680 IF KP$="N" OR KP$="n" THEN RUN GFX2("CLEAR") \ RETURN ENDIF 1690 IF KP$<>"Y" AND KP$<>"y" THEN 16701700 RUN LOCATE(5,10) \ PRINT ""1710 RUN LOCATE(7,21) \ PRINT "  This is a  simple  little game that is"1720 RUN LOCATE(8,21) \ PRINT "  played a lot like checkers. The object"1730 RUN LOCATE(9,21) \ PRINT "  of the game is to remove as many `pegs'"1740 RUN LOCATE(10,21) \ PRINT "  as possible by jumping each `peg' with"1750 RUN LOCATE(11,21) \ PRINT "  another.  You may not jump  diagonally."1760 RUN LOCATE(12,21) \ PRINT "  The peg that you jump will be  removed"1770 RUN LOCATE(13,21) \ PRINT "  from the game board automatically."1780 RUN LOCATE(16,21) \ PRINT "  First,  position the  cursor under the"1790 RUN LOCATE(17,21) \ PRINT "  jumping peg and Strike The  Enter  Key."1800 RUN LOCATE(18,21) \ PRINT "  Then,  move  the  cursor  to the empty"1810 RUN LOCATE(19,21) \ PRINT "  hole that you are jumping to and again"1820 RUN LOCATE(20,21) \ PRINT "  Strike The Enter Key."1830 RUN LOCATE(24,28) \RUN GFX2("COLOR",0,2) \ PRINT "Strike Any Key To Continue" ; 1840 RUN INKEY(KP$)IF KP$="" THEN GOTO 1840ELSE RUN GFX2("CLEAR")RETURN ENDIF 1850 XLIN=YS1 \XPOS=XS1 \RUN LOCATE(24,1) \RUN SPC(79)1860 RUN LOCATE(24,22) \ PRINT "Do You Wish To Leave This Game? <Y/N>" ; 1870 RUN INKEY(KP$) \ IF KP$="" THEN 18701880 IF KP$="y" OR KP$="Y" THEN 16001890 IF KP$<>"n" AND KP$<>"N" THEN 18701900 RUN LOCATE(24,1) \RUN SPC(79)1905 RUN LOCATE(24,1) \RUN SPC(7) \ PRINT "Position Cursor And Strike Enter.  Strike <Q> to Leave This Game." ; 1910 RUN LOCATE(XLIN,XPOS)1920 RETURN PROCEDURE LOCATEPARAM A,B:INTEGERRUN GFX2("CURXY",B-1,A-1)END PROCEDURE SPCPARAM A:INTEGERDIM T:INTEGERFOR T=1 TO APRINT " "; NEXT TEND END 