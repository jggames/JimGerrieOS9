PROCEDURE SentinelDIM key(255):INTEGERDIM ch$:STRING[480]DIM alive,dead:BOOLEANDIM bk$,br$,bt$:STRING[32]DIM s$(2),s2$(2),highname$:STRING[3]DIM m$,m1$:STRING[9]DIM x,y,a,b,w,z,highscore:INTEGERDIM b$(2):STRING[3]DIM c,e,k,t,lv,v,en,levels:INTEGERDIM i$,t1$,se$,bb$(3):STRING[1]DIM zz,dl,gl:INTEGERgl=0WHILE gl<1 OR gl>3 DOrun curonPRINT CHR$(12); GOSUB 7500PRINT " & Charlie Gerrie. Use W A S D"PRINTPRINTPRINTINPUT"          Level (1-3): ",glENDWHILE RUN curoffSHELL "tmode -echo" dl=500-(gl*100)FOR t=1 TO 255key(t)=0NEXT tkey(65)=1key(68)=2key(83)=3key(87)=4key(65+32)=1key(68+32)=2key(83+32)=3key(87+32)=4key(81)=5key(113)=5key(32)=6t1$=CHR$(128)se$=CHR$(159)bb$(1)=CHR$(182)bb$(2)=CHR$(128)bb$(3)=CHR$(185)highscore=0highname$="JBG"levels=99m$="...."+CHR$(141)+"...."b$(1)=CHR$(191)b$(2)=CHR$(191)+CHR$(191)+CHR$(191)s$(1)=CHR$(189)s$(2)=CHR$(185)+CHR$(177)+CHR$(189)s2$(1)=CHR$(157)s2$(2)=CHR$(153)+CHR$(145)+CHR$(157)ch$=""bk$=""br$=""FOR t=1 TO 32br$=br$+CHR$(191)bk$=bk$+CHR$(128)NEXT tt=RND(-(VAL(RIGHT$(DATE$,2))))REPEAT bt$=bk$dead=FALSEv=1e=-1lv=0en=10GOSUB 7000x=15 \y=12GOSUB 6000alive=TRUEREPEAT FOR zz=1 TO dlNEXT zzRUN inkey(i$)IF i$<>"" THEN k=ASC(i$)ON key(k) GOSUB 1000,2000,3000,4000,900,8000ENDIF IF NOT(dead) THEN IF RND(100)<lv THEN IF y-b>=0 THEN GOSUB 300ELSE GOSUB 400ENDIF ELSE ON v+2 GOSUB 100,100,200ENDIF ENDIF IF w>=0 THEN GOSUB 350ELSE IF NOT(dead) THEN IF (a=x OR a=x-1 OR a=x+1) AND RND(100)<10 THEN w=a \z=bob$=b$(1)ENDIF ENDIF ENDIF UNTIL alive=FALSE OR lv>levelsIF lv>=highscore OR lv>levels THEN REPEAT PRINT CHR$(12); GOSUB 7500RUN inkey(i$)UNTIL i$=""RUN curxy(10,8)IF lv>levels THEN PRINT "You escaped!"PRINT CHR$(7); CHR$(7); CHR$(7)ELSE PRINT "High Score!"; ENDIF RUN curxy(3,10)PRINT "Enter your initials"; RUN echoRUN curonINPUT highname$highscore=lvRUN curoffENDIF RUN curxy(11,15)PRINT "  Play again (y/n)?"; i$=""WHILE i$<>"y" AND i$<>"Y" AND i$<>"N" AND i$<>"n" DO RUN inkey(i$)ENDWHILE PRINT CHR$(12);SHELL "tmode -echo"UNTIL i$="n" OR i$="N"PRINT RUN echoRUN curonSHELL "tmode echo"END 100 c=32*b+aIF MID$(ch$,c,1)=t1$ THEN v=v*-1ELSE GOSUB 500a=a-1GOSUB 600ENDIF GOSUB 700RETURN 200 c=32*b+a+2IF MID$(ch$,c,1)=t1$ THEN v=v*-1ELSE GOSUB 500a=a+1GOSUB 600ENDIF GOSUB 700RETURN 300 c=32*b+a+33IF MID$(ch$,c,1)=t1$ THEN v=v*-1ELSE GOSUB 500b=b+1GOSUB 600ENDIF GOSUB 700RETURN 350 c=32*z+w+33IF MID$(ch$,c,1)=t1$ OR z=14 THEN RUN curxy(w,z)PRINT b$(1); GOSUB 800w=-99ELSE RUN curxy(w,z)PRINT b$(1); z=z+1e=e*-1RUN curxy(w,z)PRINT bb$(e+2); GOSUB 800ENDIF RETURN 400 c=32*b+a-31IF MID$(ch$,c,1)=t1$ THEN v=v*-1ELSE GOSUB 500b=b-1GOSUB 600ENDIF GOSUB 700RETURN 500 RUN curxy(a,b)PRINT b$(1); RETURN 600 RUN curxy(a,b)PRINT se$; RETURN 700 IF a=x AND b=y OR a=x-1 AND b=y+1 OR a=x+1 AND b=y+1 THEN GOSUB 6100PRINT CHR$(7); alive=FALSEENDIF RETURN 800 IF NOT(dead) THEN IF (z=y OR z=y+1) AND (w>=x-1 AND w<=x+1) THEN RUN curxy(w,z)PRINT b$(1); GOSUB 6100en=en-1RUN curxy(27,15)PRINT en; " "; IF en=0 THEN PRINT CHR$(7); alive=FALSEENDIF GOSUB 6000w=-99ENDIF ENDIF RETURN 900 alive=FALSERETURN 1000 c=32*y+xIF MID$(ch$,c,1)=t1$ OR MID$(ch$,c+31,1)=t1$ THEN ELSE GOSUB 5000x=x-1GOSUB 6000ENDIF 1050 RETURN 2000 c=32*y+x+2IF MID$(ch$,c,1)=t1$ OR MID$(ch$,c+33,1)=t1$ THEN ELSE GOSUB 5000x=x+1GOSUB 6000ENDIF 2050 RETURN 3000 c=32*y+x+64IF MID$(ch$,c,3)=b$(2) THEN GOSUB 5000y=y+1GOSUB 6000ENDIF 3050 RETURN 4000 IF y>0 THEN c=32*y+xIF MID$(ch$,c,1)=t1$ OR MID$(ch$,c+2,1)=t1$ OR MID$(ch$,c-31,1)= t1$ THEN ELSE GOSUB 5000y=y-1GOSUB 6000ENDIF ELSE IF y=-1 THEN GOSUB 5000y=13GOSUB 7000GOSUB 6000ELSE c=32*y+xIF MID$(ch$,c,1)=t1$ OR MID$(ch$,c+2,1)=t1$ THEN ELSE GOSUB 5000y=y-1GOSUB 6000ENDIF ENDIF ENDIF 4060 RETURN 5000 IF y>=0 THEN RUN curxy(x,y)PRINT b$(1); ENDIF RUN curxy(x-1,y+1)PRINT b$(2); RETURN 6000 IF y>=0 THEN RUN curxy(x,y)PRINT s$(1); ENDIF RUN curxy(x-1,y+1)PRINT s$(2); RETURN 6100 IF y>=0 THEN RUN curxy(x,y)PRINT s2$(1); ENDIF RUN curxy(x-1,y+1)PRINT s2$(2); RETURN 7000 ch$=""a=15 \b=0dead=FALSEw=a+1 \z=blv=lv+1FOR t=1 TO 13c=RND(10)+3ch$=ch$+RIGHT$(bk$,c)+RIGHT$(br$,32-(c+c))+RIGHT$(bk$,c)NEXT tch$=ch$+bt$+bt$bt$=LEFT$(ch$,32)PRINT CHR$(1); ch$; "                              "; RUN curxy(0,15)PRINT "Level "; lv; RUN curxy(20,15)PRINT "Energy "; en; RUN curxy(11,15)PRINT highname$; RUN curxy(15,15)PRINT highscore; RETURN 7500 RUN curxy(8,5)PRINT "*** Sentinel ***"RUN curxy(7,6)PRINT "By Jim Gerrie 2005"RETURN 8000 IF y>=0 THEN c=32*y+x-3m1$=MID$(ch$,c,4)+s$(1)+MID$(ch$,c+5,4)RUN curxy(x-4,y)PRINT m$;FOR zz=1 TO 250NEXT zz IF y=b AND a>=x-4 AND a<=x+4 AND NOT(dead) THEN dead=TRUEen=en+1RUN curxy(27,15)PRINT en; " "; ENDIF RUN curxy(x-4,y)PRINT m1$; ENDIF RETURN PROCEDURE curoffPRINT CHR$(5); CHR$(32); END PROCEDURE curonPRINT CHR$(5); CHR$(33); END PROCEDURE echoSHELL "tmode echo"PROCEDURE curxyPARAM x,y:INTEGERPRINT CHR$(2)+CHR$(32+x)+CHR$(32+y); END 