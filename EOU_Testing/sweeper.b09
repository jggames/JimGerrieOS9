PROCEDURE SweeperBASE 0DIM m(30,20),n(30,20),tt(4),sx(101),syy(101):INTEGERDIM hour,min,sec:INTEGERDIM starthour$,startsec$,startmin$:STRING[2]DIM b,c,z,r,mx,my,l,h,v,oh,ov,x,y:INTEGERDIM sk,st,sy:INTEGERDIM t,timer,grf1:INTEGERDIM qq$:STRING[1]x=RND(-(VAL(RIGHT$(DATE$,2))))grf1=0GOTO 101 FOR x=0 TO 29FOR y=0 TO 19m(x,y)=0n(x,y)=0NEXT yNEXT xFOR x=0 TO 3tt(x)=0NEXT xFOR x=0 TO 100sx(x)=0syy(x)=0NEXT xx=0y=0b=0c=0z=0r=0mx=0my=0l=0h=0v=0oh=0ov=05 RETURN 6 RUN GFX("COLOR",0)RUN FILL(h*8*2+2,v*8+2)RETURN 8 RUN GFX("COLOR",0)RUN FILL(h*8*2+2,v*8+2)RETURN 10 RUN GFX("ALPHA")PRINT CHR$(12);TAB(14);"Sweeper!"PRINT PRINT "    By Kenneth Reighard, Jr."PRINT "   OS9 Version by Jim Gerrie"PRINT PRINT " 1. Easy"PRINT " 2. Medium"PRINT " 3. Hard "PRINT PRINT " Select level of play or press   <Q> to quit "; 50 RUN INKEY(qq$)IF qq$="" THEN 50PRINT CHR$(8); IF qq$="q" OR qq$="Q" THEN 571IF qq$<>CHR$(49) AND qq$<>CHR$(50) AND qq$<>CHR$(51) THEN 50sk=VAL(qq$)IF sk<1 OR sk>3 THEN 50PRINT  \ PRINT PRINT "     One Moment Please... "; GOSUB 160 ON sk GOTO 65,70,7565 mx=9my=9b=10GOTO 8070 mx=12my=14b=30GOTO 8075 mx=14my=19b=5080 l=b90 r=(mx+1)*(my+1)-b95 REM Randomize Timer using H100 FOR z=1 TO b105 h=RND(mx)v=RND(my)110 IF m(h,v)=-1 THEN GOTO 105ELSE m(h,v)=-1ENDIF 115 NEXT z120 FOR v=0 TO myFOR h=0 TO mx125 IF m(h,v)<>-1 THEN 155130 FOR y=-1 TO 1FOR x=-1 TO 1135 IF x=0 AND y=0 THEN 150140 IF h+x<0 OR h+x>mx OR v+y<0 OR v+y>my THEN 150145 IF m(h+x,v+y)<>-1 THEN m(h+x,v+y)=m(h+x,v+y)+1ENDIF 150 NEXT xNEXT y155 NEXT hNEXT vRUN GFX("MODE",1,0) \ grf1=1160 RUN GFX("COLOR",0)RUN GFX("CLEAR")RUN GFX("COLOR",1)170 RUN BOX(0,0,mx*8*2+16,my*8+8)175 RUN GFX("COLOR",2)RUN FILL(2,2)RUN GFX("COLOR",1)180 FOR x=0 TO mx185 RUN GFX("LINE",x*8*2,0,x*8*2,(my+1)*8)190 NEXT x195 FOR y=0 TO my200 RUN GFX("LINE",0,y*8,(mx+1)*8*2,y*8)205 NEXT y210 h=0v=0t=0215 starthour$=MID$(DATE$,10,2)startmin$=MID$(DATE$,13,2)startsec$=MID$(DATE$,16,2)hour=VAL(starthour$)min=VAL(startmin$)sec=VAL(startsec$)timer=hour*60*60+min*60+sec220 IF l<10 THEN RUN GFX("COLOR",0)RUN PRINTNUM(108,183,10)RUN PRINTNUM(116,183,10)RUN GFX("COLOR",1)RUN PRINTNUM(116,183,l)ELSE RUN GFX("COLOR",0)RUN PRINTNUM(116,183,10)RUN PRINTNUM(108,183,10)RUN GFX("COLOR",1)RUN PRINTNUM(108,183,FIX(l/10))RUN PRINTNUM(116,183,MOD(l,10))ENDIF 230 RUN GFX("COLOR",3)RUN BOX(h*8*2,v*8,h*8*2+16,v*8+8)IF r=0 THEN 440240 RUN INKEY(qq$)IF qq$="" THEN 240245 RUN GFX("COLOR",1)RUN BOX(h*8*2,v*8,h*8*2+16,v*8+8)250 IF qq$=CHR$(8) THEN h=h-1IF h<0 THEN h=mxGOTO 230ELSE GOTO 230ENDIF ENDIF 255 IF qq$=CHR$(9) THEN h=h+1IF h>mx THEN h=0GOTO 230ELSE GOTO 230ENDIF ENDIF 260 IF qq$=CHR$(12) THEN v=v+1IF v>my THEN v=0GOTO 230ELSE GOTO 230ENDIF ENDIF 265 IF qq$=CHR$(10) THEN v=v-1IF v<0 THEN v=myGOTO 230ELSE GOTO 230ENDIF ENDIF 270 IF qq$=CHR$(13) THEN IF n(h,v)=0 AND l>0 THEN RUN GFX("COLOR",1)RUN PRINTNUM(h*8*2,v*8,11)n(h,v)=1l=l-1GOTO 220ELSE IF n(h,v)=1 THEN RUN GFX("COLOR",2)RUN PRINTNUM(h*8*2,v*8,11)n(h,v)=0l=l+1GOTO 220ELSE GOTO 220ENDIF ENDIF ENDIF 275 IF qq$<>CHR$(32) THEN 220280 IF n(h,v)<>0 THEN 220285 c=m(h,v)290 GOSUB 6295 IF c=-1 THEN 400300 r=r-1305 IF c=0 THEN n(h,v)=3GOTO 325ENDIF 310 RUN GFX("COLOR",1)RUN PRINTNUM(h*8*2,v*8,c)315 n(h,v)=2320 GOTO 230325 oh=hov=v330 st=1sx(st)=hsyy(st)=v335 IF st=0 THEN h=ohv=ovGOTO 230ENDIF 340 x=sx(st)y=syy(st)345 FOR h=x-1 TO x+1FOR v=y-1 TO y+1350 IF h<0 OR h>mx OR v<0 OR v>my THEN 390355 IF n(h,v)<>0 THEN 390360 IF m(h,v)>0 THEN n(h,v)=2r=r-1GOSUB 6RUN GFX("COLOR",1)RUN PRINTNUM(h*8*2,v*8,m(h,v))GOTO 390ENDIF 365 IF m(h,v)=-1 THEN 390370 GOSUB 6375 n(h,v)=3380 r=r-1385 st=st+1sx(st)=hsyy(st)=vGOTO 340390 NEXT vNEXT h395 st=st-1GOTO 335400 GOSUB 8RUN GFX("COLOR",1)RUN PRINTNUM(h*8*2,v*8,12)PRINT CHR$(7); 405 FOR v=0 TO myFOR h=0 TO mx410 IF m(h,v)=-1 THEN GOSUB 8RUN GFX("COLOR",3)RUN PRINTNUM(h*8*2,v*8,12)ENDIF 415 IF n(h,v)=1 AND m(h,v)<>-1 THEN RUN GFX("COLOR",3)RUN PRINTNUM(h*8*2,v*8,13)ENDIF 420 NEXT hNEXT vGOTO 470440 RUN BOX(h*8*2,v*8,h*8*2+16,v*8+8)450 FOR v=0 TO myFOR h=0 TO mx455 IF m(h,v)=-1 AND n(h,v)<>1 THEN RUN GFX("COLOR",2)RUN PRINTNUM(h*8*2,v*8,11)ENDIF 460 NEXT hNEXT v470 starthour$=MID$(DATE$,10,2)hour=VAL(starthour$)startmin$=MID$(DATE$,13,2)min=VAL(startmin$)startsec$=MID$(DATE$,16,2)sec=VAL(startsec$)t=hour*60*60+min*60+secRUN PRINTNUM(0,183,14)RUN PRINTNUM(8,183,15)RUN PRINTNUM(16,183,16)RUN PRINTNUM(24,183,17)RUN PRINTNUM(32,183,17)RUN PRINTNUM(48,183,18)475 RUN INKEY(qq$)IF qq$<>"C" AND qq$<>"c" THEN 475RUN GFX("ALPHA")PRINT CHR$(12); IF r=0 THEN PRINT "Time= "; t-timerENDIF 480 PRINT "Play Again (y/n)? "; 560 RUN INKEY(qq$)IF qq$="Y" OR qq$="y" THEN GOTO 10ENDIF IF qq$<>"N" AND qq$<>"n" THEN 560570 RUN GFX("ALPHA")PRINT 571 IF grf1=1 THENRUN GFX("QUIT")ENDIFEND PROCEDURE BoxPARAM hstart,vstart,hend,vend:INTEGERRUN gfx("LINE",hstart,vstart,hend,vstart)RUN gfx("LINE",hstart,vstart,hstart,vend)RUN gfx("LINE",hend,vstart,hend,vend)RUN gfx("LINE",hend,vend,hstart,vend)END PROCEDURE FillPARAM x,y:INTEGERRUN GFX("MOVE",x,y)PRINT CHR$(29); END PROCEDURE PrintnumPARAM x,y,c:INTEGERIF c=0 THEN GOSUB 1GOSUB 2GOSUB 3GOSUB 4GOSUB 5GOSUB 7GOTO 10ENDIF IF c=1 THEN GOSUB 1GOSUB 3GOTO 10ENDIF IF c=2 THEN GOSUB 5GOSUB 2GOSUB 6GOSUB 3GOSUB 7GOTO 10ENDIF IF c=3 THEN GOSUB 5GOSUB 2GOSUB 6GOSUB 4GOSUB 7GOTO 10ENDIF IF c=4 THEN GOSUB 1GOSUB 6GOSUB 2GOSUB 4GOTO 10ENDIF IF c=5 THEN GOSUB 5GOSUB 1GOSUB 6GOSUB 4GOSUB 7GOTO 10ENDIF IF c=6 THEN GOSUB 5GOSUB 1GOSUB 6GOSUB 4GOSUB 7GOSUB 3GOTO 10ENDIF IF c=7 THEN GOSUB 5GOSUB 2GOSUB 4GOTO 10ENDIF IF c=8 THEN GOSUB 1GOSUB 2GOSUB 3GOSUB 4GOSUB 5GOSUB 6GOSUB 7GOTO 10ENDIF IF c=9 THEN GOSUB 1GOSUB 5GOSUB 6GOSUB 2GOSUB 4GOTO 10ENDIF IF c=10 THEN GOSUB 1GOSUB 2GOSUB 3GOSUB 4GOSUB 5GOSUB 6GOSUB 7GOSUB 8GOTO 10ENDIF IF c=11 THEN GOSUB 3GOSUB 5GOSUB 6GOSUB 2GOSUB 1GOSUB 8GOTO 10ENDIF IF c=12 THEN GOSUB 5GOSUB 7RUN GFX("LINE",x+8,y+1,x+8,y+7)RUN GFX("LINE",x+4,y+3,x+4,y+5)RUN GFX("LINE",x+12,y+3,x+12,y+5)RUN GFX("LINE",x+4,y+4,x+12,y+4)GOTO 10ENDIF IF c=13 THEN RUN GFX("LINE",x,y,x+16,y+8)RUN GFX("LINE",x,y+8,x+16,y)GOTO 10ENDIF IF c=14 THEN GOSUB 1GOSUB 2GOSUB 3GOSUB 6GOSUB 5GOTO 10ENDIF IF c=15 THEN GOSUB 1GOSUB 2GOSUB 3GOSUB 6GOSUB 5RUN GFX("POINT",x+10,y+2)RUN GFX("POINT",x+8,y+3)GOTO 10ENDIF IF c=16 THEN GOSUB 5GOSUB 1GOSUB 6GOSUB 3GOSUB 7GOTO 10ENDIF IF c=17 THEN GOSUB 5GOSUB 1GOSUB 6GOSUB 4GOSUB 7GOTO 10ENDIF IF c=18 THEN GOSUB 5GOSUB 1GOSUB 3GOSUB 7GOTO 10ENDIF GOTO 101 RUN GFX("LINE",x+6,y+4,x+6,y+6)RETURN 2 RUN GFX("LINE",x+10,y+4,x+10,y+6)RETURN 3 RUN GFX("LINE",x+6,y+2,x+6,y+4)RETURN 4 RUN GFX("LINE",x+10,y+2,x+10,y+4)RETURN 5 RUN GFX("LINE",x+6,y+6,x+10,y+6)RETURN 6 RUN GFX("LINE",x+6,y+4,x+10,y+4)RETURN 7 RUN GFX("LINE",x+6,y+2,x+10,y+2)RETURN 8 RUN GFX("LINE",x+6,y+5,x+10,y+5)RUN GFX("LINE",x+6,y+1,x+6,y+5)RETURN 10 END 