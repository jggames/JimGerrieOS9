PROCEDURE cavehunt1DIM a(22,22),F(6,8),W(3):INTEGERDIM cw$,lo$,bl$,a$:STRING[2]DIM selc,cs,choice:INTEGERBASE 0choice=1PRINT CHR$(12); PRINT "Enter Screen Type:"PRINT "1=CoCo  2=Hires  3=Terminal"INPUT "Choice: ",choiceIF choice=1 THEN cs=12cw$="#"lo$="X"bl$=" "ELSE cs=24cw$="[]"lo$="><"bl$="  "IF choice=2 THEN cs=12ENDIF ENDIF 5 PRINT CHR$(cs)PRINT  \ PRINT PRINT TAB(44); "CAVEHUNT"PRINT PRINT TAB(38); KP=RND(-(VAL(RIGHT$(DATE$,2))))INPUT "Hit <CR> to begin ",a$10 PRINT CHR$(cs); KP=0PRINT "PROGRAM IS PROCESSING -- PLEASE WAIT"DATA 7,0,5,-2,-5,5,12,8,4,2,4,0,0DATA -5,3,3,0,1,1,-4,-8,12,0,12,-5DATA 0,12,12,6,5,2,4,-1,-2,-7FOR I=1 TO 5FOR N=1 TO 7READ selcF(I,N):=selcNEXT NNEXT I20 RESTORE 30 FOR X=0 TO 2135 FOR Y=0 TO 2140 a(X,Y)=045 NEXT Y50 NEXT X120 FOR Y=1 TO 20130 FOR I=1 TO 6135 X=INT(20*RND(0))+1140 a(X,Y)=1170 NEXT I \NEXT Y172 Y=0174 FOR X=0 TO 21 \a(X,Y)=-1 \NEXT X176 Y=21178 FOR X=0 TO 21 \a(X,Y)=-1 \NEXT X180 X=0182 FOR Y=1 TO 20 \a(X,Y)=-1 \NEXT Y184 X=21186 FOR Y=1 TO 20 \a(X,Y)=-1 \NEXT Y190 FOR Y=1 TO 20200 FOR I=1 TO 5205 X=INT(20*RND(0))+1210 IF a(X,Y)<>0 THEN 205220 a(X,Y)=INT(5*RND(0))+2230 NEXT I \NEXT Y250 PX=INT(4*RND(0))+9260 PY=INT(4*RND(0))+9265 LX=PX270 LY=PY290 FOR Y=1 TO 20295 FOR I=1 TO 3300 X=INT(20*RND(0))+1310 IF a(X,Y)<>0 THEN 300320 a(X,Y)=INT(7*RND(0))+7330 NEXT I \NEXT Y340 GOSUB 4000345 PRINT CHR$(cs); TAB(9); "*** Cave Hunt ***"PRINTPRINT "You find yourself in a dark"PRINT "cave armed only with a knife."PRINT "You may carry only two weapons"PRINT "at a time, those two of your"PRINT "choice.  You may pick up new"PRINT "weapons as you go, but you may"PRINT "have to put some down.  Some"PRINT "weapons are more effective than"PRINT "others against the creatures"PRINT "you may meet. You get points"PRINT "for the creatures that you kill."375 PRINT "Hit <CR> to Begin. Good Luck!"380 INPUT a$385 W(1)=7 \W(2)=20a(PX,PY)=0390 PRINT CHR$(cs)400 PRINT "YOU ARE IN A DARK PASSAGE."410 PRINT 415 IF a(PX,PY)<0 THEN 3000420 N=a(PX,PY-1)430 S=a(PX,PY+1)440 E=a(PX+1,PY)450 O=a(PX-1,PY)455 LX=PX \LY=PY460 IF N>1 AND N<7 OR S>1 AND S<7 OR E>1 AND E<7 OR O>1 AND O<7 THEN 510470 LY=PY495 LX=PX500 GOTO 520510 PRINT "THERE IS A SOUND NEARBY"515 PRINT 520 PRINT "WHICH DIRECTION DO YOU GO?"530 IF N=1 THEN 550540 PRINT "NORTH-ENTER 1"550 IF S=1 THEN 570560 PRINT "SOUTH-ENTER 2"570 IF E=1 THEN 590580 PRINT "EAST -ENTER 3"590 IF O=1 THEN 610600 PRINT "WEST -ENTER 4"610 INPUT DIF N=1 AND D=1 OR S=1 AND D=2 OR E=1 AND D=3 OR O=1 AND D=4 THEN 610620 ON D GOTO 650,670,690,710630 PRINT "INVALID CHOICE -- REENTER"640 GOTO 610650 PY=PY-1660 GOTO 720670 PY=PY+1680 GOTO 720690 PX=PX+1700 GOTO 720710 PX=PX-1720 IF a(PX,PY)=-1 THEN 3000725 IF a(PX,PY)<2 THEN 390729 IF a(PX,PY)>1 AND a(PX,PY)<7 THEN 1080730 PRINT CHR$(cs)740 PRINT "YOU ARE PRESENTLY CARRYING "741 IF W(1)=20 AND W(2)=20 THEN PRINT "NO WEAPONS"GOTO 850ENDIF 745 FOR I=1 TO 2IF I=2 AND W(2)<>20 THEN PRINT " AND "; ENDIF 746 IF I=2 AND W(2)=20 THEN 840750 selc=W(I)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060840 NEXT I850 PRINT 860 PRINT "IN THIS PLACE YOU FIND "870 selc=a(PX,PY)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060880 PRINT  \ PRINT "WILL YOU PICK IT UP (Y OR N)"; 885 INPUT a$890 IF a$="Y" OR a$="y" THEN 920900 IF a$="N" OR a$="n" THEN 1030910 GOTO 880920 IF W(1)=20 OR W(2)=20 THEN 1040930 PRINT  \ PRINT "WHAT DO YOU WISH TO LEAVE?"940 selc=W(1)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060945 PRINT "-1"950 selc=W(2)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060955 PRINT "-2"960 INPUT I970 IF I=1 THEN 1000980 IF I=2 THEN 1020990 PRINT "INVALID"GOTO 9601000 G=a(PX,PY) \a(PX,PY)=W(1) \W(1)=G \G=01010 GOTO 10301020 G=a(PX,PY) \a(PX,PY)=W(2) \W(2)=G \G=01030 GOTO 3901040 IF W(1)<>20 THEN 10601045 W(1)=a(PX,PY) \a(PX,PY)=01050 GOTO 3901060 W(2)=a(PX,PY) \a(PX,PY)=01070 GOTO 3901080 PRINT CHR$(cs)1090 PRINT "YOU HAVE ENTERED A ROOM WITH"1100 selc=a(PX,PY)-1ON selc GOSUB 5070,5080,5090,5100,51101110 PRINT  \ PRINT "YOU ARE ARMED WITH "; 1115 IF W(1)=20 AND W(2)=20 THEN PRINT "NOTHING!"ENDIF 1120 IF W(1)=20 THEN 11501125 selc=W(1)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,50601130 IF W(1)=20 OR W(2)=20 THEN 11501140 PRINT " AND "; 1150 IF W(2)=20 THEN 11601155 selc=W(2)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,50601160 PRINT  \ PRINT "WILL YOU ATTACK OR RUN (A OR R)"; INPUT a$1170 IF a$="R" OR a$="r" THEN 12001180 IF a$="A" OR a$="a" THEN 13001190 PRINT "INVALID"GOTO 11601200 RN=INT(6*RND(0))+11225 D=01240 IF a(PX,PY)=2 AND RN<4 THEN D=1ENDIF 1245 IF a(PX,PY)<>2 AND RN<2 THEN D=1ENDIF 1250 IF D=0 THEN 12701260 PRINT CHR$(cs)FOR I=1 TO 6 \ PRINT "TOO SLOW -- YOU'RE DEAD" \NEXT I1265 GOTO 80001270 PX=LX \PY=LY1280 PRINT CHR$(cs)1285 PRINT "YOU RUN BACK THE WAY YOU CAME"1286 FOR I=1 TO 2000 \NEXT I1290 GOTO 3901300 IF W(1)=20 AND W(2)=20 THEN PRINT "YOU HAVE NO WEAPONS -- YOU MUST RUN"GOTO 1160ENDIF 1310 PRINT CHR$(cs)1315 FOR I=1 TO 21317 IF W(I)=20 THEN 13401320 selc=W(I)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,50601330 PRINT "-"; I1340 NEXT I1350 PRINT  \ PRINT "WHICH WEAPON WILL YOU USE"; INPUT I1360 IF I=1 THEN AW=W(1)ENDIF 1370 IF I=2 THEN AW=W(2)ENDIF 1375 GOTO 13901380 PRINT "INVALID"GOTO 13151390 RL=INT(20*RND(0))+1+F(a(PX,PY)-1,AW-6)1400 IF RL<5 THEN 16201410 IF RL>4 AND RL<9 THEN 16001420 IF RL>9 AND RL<13 THEN 15401430 IF RL>12 AND RL<17 THEN 15001440 PRINT CHR$(cs)1450 FOR I=1 TO 61460 PRINT "YOU DIED FIGHTING . . ."1470 NEXT I1490 GOTO 80001500 IF W(2)=20 THEN 1540PRINT CHR$(cs)PRINT "YOU LOST BOTH WEAPONS -- RUN!"1510 W(1)=20 \W(2)=201520 FOR I=1 TO 2000 \NEXT I1530 GOTO 3901540 PRINT CHR$(cs) \ PRINT "YOU LOSE YOUR ATTACK WEAPON --- RUN!"1545 FOR I=1 TO 2000 \NEXT I1550 IF W(1)=W(2) THEN 15701560 IF AW=W(1) THEN W(1)=W(2)W(2)=20GOTO 390ENDIF 1570 IF AW=W(2) THEN W(2)=20ENDIF 1590 GOTO 3901600 PRINT CHR$(cs)PRINT "THE BATTLE'S A DRAW . . ."1610 GOTO 11601620 PRINT CHR$(cs)1630 PRINT "SUCCESS --- YOU'VE KILLED IT!"FOR t=1 TO 2000 \NEXT t1640 IF a(PX,PY)=2 OR a(PX,PY)=3 THEN KP=KP+5ENDIF 1650 IF a(PX,PY)=4 THEN KP=KP+2ENDIF 1660 IF a(PX,PY)=5 THEN KP=KP+4ENDIF 1670 IF a(PX,PY)=6 THEN KP=KP+3ENDIF 1675 a(PX,PY)=01680 GOTO 3903000 PRINT CHR$(cs)3005 FOR I=1 TO 103010 PRINT "YOU'VE ESCAPED ALIVE!!"3050 NEXT I3060 GOTO 80004000 TY=PY4010 TX=PX4020 TR=INT(8*RND(0))+14030 ON TR GOSUB 4500,4550,4600,4650,4700,4750,4800,48504040 RETURN 4500 IF a(TX,TY)=-1 THEN RETURN ENDIF 4510 IF a(TX-1,TY)<>0 THEN TX=TX-1GOTO 4500ENDIF 4520 IF a(TX,TY+1)<>0 THEN TY=TY+1GOTO 4500ENDIF 4525 T1=INT(2*RND(0))+14530 IF T1=1 THEN 45404535 TX=TX-1a(TX,TY)=0GOTO 45104540 TY=TY+1a(TX,TY)=0GOTO 45104550 IF a(TX,TY)=-1 THEN RETURN ENDIF 4560 IF a(TX-1,TY)<>0 THEN TX=TX-1GOTO 4550ENDIF 4570 IF a(TX,TY-1)<>0 THEN TY=TY-1GOTO 4550ENDIF 4575 T1=INT(2*RND(0))+14580 IF T1=1 THEN 45904585 TX=TX-1 \a(TX,TY)=0 \ GOTO 45604590 TY=TY-1 \a(TX,TY)=0 \ GOTO 45604600 IF a(TX,TY)=-1 THEN RETURN ENDIF 4610 IF a(TX,TY+1)<>0 THEN TY=TY+1GOTO 4600ENDIF 4620 IF a(TX-1,TY)<>0 THEN TX=TX-1GOTO 4600ENDIF 4625 T1=INT(2*RND(0))+14630 IF T1=1 THEN 46404635 TY=TY+1 \a(TX,TY)=0 \ GOTO 46104640 TX=TX-1 \a(TX,TY)=0 \ GOTO 46104650 IF a(TX,TY)=-1 THEN RETURN ENDIF 4660 IF a(TX,TY+1)<>0 THEN TY=TY+1GOTO 4650ENDIF 4670 IF a(TX+1,TY)<>0 THEN TX=TX+1GOTO 4650ENDIF 4675 T1=INT(2*RND(0))+14680 IF T1=1 THEN 46904685 TY=TY+1 \a(TX,TY)=0 \ GOTO 46604690 TX=TX+1 \a(TX,TY)=0 \ GOTO 46604700 IF a(TX,TY)=-1 THEN RETURN ENDIF 4710 IF a(TX+1,TY)<>0 THEN TX=TX+1GOTO 4700ENDIF 4720 IF a(TX,TY+1)<>0 THEN TY=TY+1GOTO 4700ENDIF 4725 T1=INT(2*RND(0))+14730 IF T1=1 THEN 47404735 TX=TX+1 \a(TX,TY)=0 \ GOTO 47104740 TY=TY+1 \a(TX,TY)=0 \ GOTO 47104750 IF a(TX,TY)=-1 THEN RETURN ENDIF 4760 IF a(TX+1,TY)<>0 THEN TX=TX+1GOTO 4750ENDIF 4770 IF a(TX,TY-1)<>0 THEN TY=TY-1GOTO 4750ENDIF 4775 T1=INT(2*RND(0))+14780 IF T1=1 THEN 47904785 TX=TX+1a(TX,TY)=0GOTO 47604790 TY=TY-1a(TX,TY)=0GOTO 47604800 IF a(TX,TY)=-1 THEN RETURN ENDIF 4810 IF a(TX,TY-1)<>0 THEN TY=TY-1GOTO 4800ENDIF 4820 IF a(TX+1,TY)<>0 THEN TX=TX+1GOTO 4800ENDIF 4825 T1=INT(2*RND(0))+14830 IF T1=1 THEN 48404835 TY=TY-1 \a(TX,TY)=0 \ GOTO 48104840 TX=TX+1 \a(TX,TY)=0 \ GOTO 48104850 IF a(TX,TY)=-1 THEN RETURN ENDIF 4860 IF a(TX,TY-1)<>0 THEN TY=TY-1GOTO 4850ENDIF 4870 IF a(TX-1,TY)<>0 THEN TX=TX-1GOTO 4850ENDIF 4875 T1=INT(2*RND(0))+14880 IF T1=1 THEN 48904885 TY=TY-1 \a(TX,TY)=0 \ GOTO 48604890 TX=TX-1 \a(TX,TY)=0 \ GOTO 48605000 PRINT "A KNIFE";  \ RETURN 5010 PRINT "A MAGIC STAFF";  \ RETURN 5020 PRINT "A BROAD SWORD";  \ RETURN 5030 PRINT "A DIAMOND OF LIFE";  \ RETURN 5040 PRINT "FIRE OF THE DEPTHS";  \ RETURN 5050 PRINT "A GREAT AX";  \ RETURN 5060 PRINT "A LASER SWORD";  \ RETURN 5070 PRINT "A WIZARD." \ RETURN 5080 PRINT "A GIANT SPIDER." \ RETURN 5090 PRINT "A TROLL." \ RETURN 5100 PRINT "ONE OF THE UNDEAD." \ RETURN 5110 PRINT "A GREAT BEAR." \ RETURN 8000 GOSUB 8050PRINT "KILL POINTS:"; PRINT USING "i7"; KP,8005 INPUT "Try it again (y/n)? ",a$8020 IF a$="Y" OR a$="y" THEN 108030 IF a$="N" OR a$="n" THEN END ENDIF 8040 GOTO 80058050 REM Print Map8060 FOR Y=0 TO 218070 FOR X=0 TO 21IF a(X,Y)=1 THEN PRINT cw$; ELSE IF X=PX AND Y=PY THEN PRINT lo$; ELSE PRINT bl$; ENDIF ENDIF NEXT X \ PRINT  \NEXT Y8110 RETURN 