PROCEDURE Cavehunt2DIM a(22,22),F(6,8),W(3):INTEGERDIM cw$,lo$,bl$,a$,PF:STRING[2]DIM selc,choice:INTEGERDIM S$:STRING[32]DIM N,S,E,O,G,X,Y:INTEGERDIM RN,I,AW,RL,KP,PP:INTEGERDIM D,LX,LY,PX,PY,TX,TY,TR,T1:INTEGERBASE 0cw$="#"lo$="X"bl$=" "RUN CLS(0)KP=RND(-(VAL(RIGHT$(DATE$,2))))PF=" "WHILE PF<>"y" AND PF<>"Y" AND PF<>"n" AND PF<>"N" DO PRINT "USE SPEECH SOUND PACK?"PRINT "ENTER Y OR N" \ INPUT PFENDWHILE IF PF="y" OR PF="Y" THEN SHELL "load ssc;link ssc"PP=2PF=" "WHILE PF<>"y" AND PF<>"Y" AND PF<>"n" AND PF<>"N" DO PRINT "PRINT TO SCREEN? ENTER Y OR N" \ INPUT PFENDWHILE IF PF="y" OR PF="Y" THEN PP=4ENDIF ELSE PP=0ENDIF 10 RUN CLS(PP+1)RUN Talk(PP+1,"PROGRAM IS PROCESSING")RUN Talk(PP+1,"PLEASE WAIT")RUN Slowdown(4)KP=0FOR I=1 TO 5FOR N=1 TO 7READ selcF(I,N):=selcNEXT NNEXT I20 RESTORE 30 FOR X=0 TO 2135 FOR Y=0 TO 2140 a(X,Y)=045 NEXT Y50 NEXT X120 FOR Y=1 TO 20130 FOR I=1 TO 6135 X=RND(20)+1140 a(X,Y)=1170 NEXT I \NEXT YY=0FOR X=0 TO 21 \a(X,Y)=-1 \NEXT XY=21FOR X=0 TO 21 \a(X,Y)=-1 \NEXT XX=0FOR Y=1 TO 20 \a(X,Y)=-1 \NEXT YX=21FOR Y=1 TO 20 \a(X,Y)=-1 \NEXT Y190 FOR Y=1 TO 20200 FOR I=1 TO 5205 X=RND(20)+1210 IF a(X,Y)<>0 THEN 205220 a(X,Y)=RND(5)+2230 NEXT I \NEXT Y250 PX=RND(4)+9260 PY=RND(4)+9265 LX=PX270 LY=PY290 FOR Y=1 TO 20295 FOR I=1 TO 3300 X=RND(20)+1310 IF a(X,Y)<>0 THEN 300320 a(X,Y)=RND(7)+7330 NEXT I \NEXT Y340 GOSUB 4000RUN CLS(PP+1) \ PRINT TAB(7); RUN Talk(PP+1,"WELCOME TO CAVE HUNT")PRINT RUN Talk(PP+1,"You find yourself in a dark")RUN Talk(PP+1,"cave armed only with a knife.")RUN Talk(PP+1,"You may carry only two weapons")RUN Talk(PP+1,"at a time, those two of your")RUN Talk(PP+1,"choice.  You may pick up new")RUN Talk(PP+1,"weapons as you go, but you may")RUN Talk(PP+1,"have to put some down.  Some")RUN Talk(PP+1," weapons are more effective than")RUN Talk(PP+1,"others against the creatures")RUN Talk(PP+1,"you may meet.  You get points")RUN Talk(PP+1,"for the creatures that you kill.")RUN Talk(PP+1,"Hit ENTER to begin. Good luck!")380 INPUT a$385 W(1)=7 \W(2)=20 \a(PX,PY)=0390 RUN CLS(PP)400 RUN Talk(PP," YOU ARE IN A DARK PASSAGE.")410 RUN PN(PP)415 IF a(PX,PY)<0 THEN 3000420 N=a(PX,PY-1)430 S=a(PX,PY+1)440 E=a(PX+1,PY)450 O=a(PX-1,PY)455 LX=PX \LY=PY460 IF N>1 AND N<7 OR S>1 AND S<7 OR E>1 AND E<7 OR O>1 AND O<7 THEN
510470 LY=PY495 LX=PX500 GOTO 520510 RUN Talk(PP,"THERE IS A SOUND NEAR BY.")515 RUN PN(PP)520 RUN Talk(PP,"WHICH DIRECTION WILL YOU GO?")530 IF N=1 THEN 550540 RUN Talk(PP," N NORTH")550 IF S=1 THEN 570560 RUN Talk(PP," S SOUTH")570 IF E=1 THEN 590580 RUN Talk(PP," E EAST")590 IF O=1 THEN 610600 RUN Talk(PP," W WEST")610 INPUT a$D=0IF a$="N" OR a$="n" THEN D=1 \ ENDIF IF a$="S" OR a$="s" THEN D=2 \ ENDIF IF a$="E" OR a$="e" THEN D=3 \ ENDIF IF a$="W" OR a$="w" THEN D=4 \ ENDIF IF a$="Q" OR a$="q" THEN 8000IF N=1 AND D=1 OR S=1 AND D=2 OR E=1 AND D=3 OR O=1 AND D=4 THEN
520620 ON D GOTO 650,670,690,710630 RUN Talk(PP,"INVALID CHOICE") \RUN Talk(PP,"TRY AGAIN")640 GOTO 520650 PY=PY-1660 GOTO 720670 PY=PY+1680 GOTO 720690 PX=PX+1700 GOTO 720710 PX=PX-1720 IF a(PX,PY)=-1 THEN 3000725 IF a(PX,PY)<2 THEN 390729 IF a(PX,PY)>1 AND a(PX,PY)<7 THEN 1080730 RUN CLS(PP)740 RUN Talk(PP," YOU ARE PRESENTLY CARRYING")741 IF W(1)=20 AND W(2)=20 THEN RUN Talk(PP,"NO WEAPONS.")GOTO 850ENDIF 745 FOR I=1 TO 2IF I=2 AND W(2)<>20 THEN RUN Talk(PP,"AND")ENDIF 746 IF I=2 AND W(2)=20 THEN 840750 selc=W(I)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060840 NEXT I850 RUN PN(PP)860 RUN Talk(PP,"IN THIS PLACE YOU FIND")870 selc=a(PX,PY)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060880 RUN PN(PP) \RUN Talk(PP,"WILL YOU PICK IT UP?")RUN Talk(PP,"ENTER Y OR N")885 INPUT a$890 IF a$="Y" OR a$="y" THEN 920900 IF a$="N" OR a$="n" THEN 1030910 GOTO 880920 IF W(1)=20 OR W(2)=20 THEN 1040930 RUN CLS(PP) \RUN Talk(PP,"WHAT DO YOU WISH TO LEAVE?")940 selc=W(1)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060945 RUN Talk(PP,"ENTER 1")950 selc=W(2)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060955 RUN Talk(PP,"ENTER 2")960 INPUT I970 IF I=1 THEN 1000980 IF I=2 THEN 1020990 RUN Talk(PP,"INVALID RESPONSE") \ GOTO 9601000 G=a(PX,PY) \a(PX,PY)=W(1) \W(1)=G \G=01010 GOTO 10301020 G=a(PX,PY) \a(PX,PY)=W(2) \W(2)=G \G=01030 GOTO 3901040 IF W(1)<>20 THEN 10601045 W(1)=a(PX,PY) \a(PX,PY)=01050 GOTO 3901060 W(2)=a(PX,PY) \a(PX,PY)=01070 GOTO 3901080 RUN CLS(PP)1090 RUN Talk(PP," YOU HAVE ENTERED A ROOM WITH")1100 selc=a(PX,PY)-1ON selc GOSUB 5070,5080,5090,5100,51101110 RUN PN(PP) \RUN Talk(PP," YOU ARE ARMED WITH")1115 IF W(1)=20 AND W(2)=20 THEN RUN Talk(PP,"NOTHING!")ENDIF 1120 IF W(1)=20 THEN 11501125 selc=W(1)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,50601130 IF W(1)=20 OR W(2)=20 THEN 11501140 RUN Talk(PP,"AND")1150 IF W(2)=20 THEN 11601155 selc=W(2)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,50601160 RUN PN(PP) \RUN Talk(PP,"WILL YOU ATTACK OR RUN?")RUN Talk(PP,"ENTER A OR R")INPUT a$1170 IF a$="R" OR a$="r" THEN 12001180 IF a$="A" OR a$="a" THEN 13001190 RUN Talk(PP,"INVALID RESPONSE")GOTO 11601200 RN=RND(6)+11225 D=01240 IF a(PX,PY)=2 AND RN<4 THEN D=1ENDIF 1245 IF a(PX,PY)<>2 AND RN<2 THEN D=1ENDIF 1250 IF D=0 THEN 12701260 RUN CLS(PP)FOR I=1 TO 3RUN Talk(PP,"TOO SLOW")RUN Talk(PP," YOU ARE DEAD")NEXT I1265 GOTO 80001270 PX=LX \PY=LY1280 RUN CLS(PP)1285 RUN Talk(PP," YOU RUN BACK THE WAY YOU CAME")RUN Slowdown(PP)1290 GOTO 3901300 IF W(1)=20 AND W(2)=20 THEN RUN Talk(PP," YOU HAVE NO WEAPONS.")RUN Talk(PP," YOU MUST RUN!")GOTO 1160ENDIF 1310 RUN CLS(PP)1315 RUN Talk(PP,"WHICH WEAPON WILL YOU USE?")1316 FOR I=1 TO 21317 IF W(I)=20 THEN 13401320 selc=W(I)-6ON selc GOSUB 5000,5010,5020,5030,5040,5050,5060S$="ENTER "+STR$(FIX(I))1330 RUN Talk(PP,S$)1340 NEXT IINPUT IIF I<1 OR I>2 THEN 13151360 IF I=1 AND W(I)<>20 THEN AW=W(1)GOTO 1390ELSE IF I=2 AND W(I)<>20 THEN AW=W(2)GOTO 1390ELSE 1380 RUN Talk(PP,"INVALID RESPONSE")GOTO 1315ENDIF ENDIF 1390 RL=RND(20)+1+F(a(PX,PY)-1,AW-6)1400 IF RL<5 THEN 16201410 IF RL>4 AND RL<9 THEN 16001420 IF RL>9 AND RL<13 THEN 15401430 IF RL>12 AND RL<17 THEN 15001440 RUN CLS(PP)1450 FOR I=1 TO 31460 RUN Talk(PP+1," YOU DIED FIGHTING")1470 NEXT I1490 GOTO 80001500 IF W(2)=20 THEN 1540RUN CLS(PP)RUN Talk(PP," YOU LOST BOTH WEAPONS.")RUN Talk(PP,"RUN AWAY!")1510 W(1)=20 \W(2)=20RUN Slowdown(PP)1530 GOTO 3901540 RUN CLS(PP) \RUN Talk(PP," YOU LOSE YOUR ATTACK WEAPON.") \RUN Talk(PP,"RUN AWAY!")RUN Slowdown(PP)1550 IF W(1)=W(2) THEN 15701560 IF AW=W(1) THEN W(1)=W(2)W(2)=20GOTO 390ENDIF 1570 IF AW=W(2) THEN W(2)=20ENDIF 1590 GOTO 3901600 RUN CLS(PP)RUN Talk(PP,"THE BATTLE IS A DRAW.")1610 GOTO 11601620 RUN CLS(PP)1630 RUN Talk(PP,"SUCCESS! YOU HAVE KILLED IT!")RUN Slowdown(PP)1640 IF a(PX,PY)=2 OR a(PX,PY)=3 THEN KP=KP+5 \ ENDIF 1650 IF a(PX,PY)=4 THEN KP=KP+2 \ ENDIF 1660 IF a(PX,PY)=5 THEN KP=KP+4 \ ENDIF 1670 IF a(PX,PY)=6 THEN KP=KP+3 \ ENDIF 1675 a(PX,PY)=01680 GOTO 3903000 RUN CLS(PP)3005 FOR I=1 TO 33010 RUN Talk(PP+1," YOU HAVE ESCAPED ALIVE")3050 NEXT I3060 GOTO 80004000 TY=PY4010 TX=PX4020 TR=RND(8)+14030 ON TR GOSUB 4500,4550,4600,4650,4700,4750,4800,48504040 RETURN 4500 IF a(TX,TY)=-1 THEN RETURN ENDIF 4510 IF a(TX-1,TY)<>1 THEN TX=TX-1GOTO 4500ENDIF 4520 IF a(TX,TY+1)<>1 THEN TY=TY+1GOTO 4500ENDIF 4525 T1=RND(2)+14530 IF T1=1 THEN 45404535 TX=TX-1 \a(TX,TY)=0 \ GOTO 45104540 TY=TY+1 \a(TX,TY)=0 \ GOTO 45104550 IF a(TX,TY)=-1 THEN RETURN ENDIF 4560 IF a(TX-1,TY)<>1 THEN TX=TX-1GOTO 4550ENDIF 4570 IF a(TX,TY-1)<>1 THEN TY=TY-1GOTO 4550ENDIF 4575 T1=RND(2)+14580 IF T1=1 THEN 45904585 TX=TX-1 \a(TX,TY)=0 \ GOTO 45604590 TY=TY-1 \a(TX,TY)=0 \ GOTO 45604600 IF a(TX,TY)=-1 THEN RETURN ENDIF 4610 IF a(TX,TY+1)<>1 THEN TY=TY+1GOTO 4600ENDIF 4620 IF a(TX-1,TY)<>1 THEN TX=TX-1GOTO 4600ENDIF 4625 T1=RND(2)+14630 IF T1=1 THEN 46404635 TY=TY+1 \a(TX,TY)=0 \ GOTO 46104640 TX=TX-1 \a(TX,TY)=0 \ GOTO 46104650 IF a(TX,TY)=-1 THEN RETURN ENDIF 4660 IF a(TX,TY+1)<>1 THEN TY=TY+1GOTO 4650ENDIF 4670 IF a(TX+1,TY)<>1 THEN TX=TX+1GOTO 4650ENDIF 4675 T1=RND(2)+14680 IF T1=1 THEN 46904685 TY=TY+1 \a(TX,TY)=0 \ GOTO 46604690 TX=TX+1 \a(TX,TY)=0 \ GOTO 46604700 IF a(TX,TY)=-1 THEN RETURN ENDIF 4710 IF a(TX+1,TY)<>1 THEN TX=TX+1GOTO 4700ENDIF 4720 IF a(TX,TY+1)<>1 THEN TY=TY+1GOTO 4700ENDIF 4725 T1=RND(2)+14730 IF T1=1 THEN 47404735 TX=TX+1 \a(TX,TY)=0 \ GOTO 47104740 TY=TY+1 \a(TX,TY)=0 \ GOTO 47104750 IF a(TX,TY)=-1 THEN RETURN ENDIF 4760 IF a(TX+1,TY)<>1 THEN TX=TX+1GOTO 4750ENDIF 4770 IF a(TX,TY-1)<>1 THEN TY=TY-1GOTO 4750ENDIF 4775 T1=RND(2)+14780 IF T1=1 THEN 47904785 TX=TX+1 \a(TX,TY)=0 \ GOTO 47604790 TY=TY-1 \a(TX,TY)=0 \ GOTO 47604800 IF a(TX,TY)=-1 THEN RETURN ENDIF 4810 IF a(TX,TY-1)<>1 THEN TY=TY-1GOTO 4800ENDIF 4820 IF a(TX+1,TY)<>1 THEN TX=TX+1GOTO 4800ENDIF 4825 T1=RND(2)+14830 IF T1=1 THEN 48404835 TY=TY-1 \a(TX,TY)=0 \ GOTO 48104840 TX=TX+1 \a(TX,TY)=0 \ GOTO 48104850 IF a(TX,TY)=-1 THEN RETURN ENDIF 4860 IF a(TX,TY-1)<>1 THEN TY=TY-1GOTO 4850ENDIF 4870 IF a(TX-1,TY)<>1 THEN TX=TX-1GOTO 4850ENDIF 4875 T1=RND(2)+14880 IF T1=1 THEN 48904885 TY=TY-1 \a(TX,TY)=0 \ GOTO 48604890 TX=TX-1 \a(TX,TY)=0 \ GOTO 48605000 RUN Talk(PP,"A KNIFE") \ RETURN 5010 RUN Talk(PP,"A WAND") \ RETURN 5020 RUN Talk(PP,"A BROAD SWORD") \ RETURN 5030 RUN Talk(PP,"A DIAMOND OF LIFE") \ RETURN 5040 RUN Talk(PP,"FIRE OF THE DEPTHS") \ RETURN 5050 RUN Talk(PP,"A GREAT AX") \ RETURN 5060 RUN Talk(PP,"A LIGHT SABER") \ RETURN 5070 RUN Talk(PP,"A WIZARD") \ RETURN 5080 RUN Talk(PP,"A GIANT SPIDER") \ RETURN 5090 RUN Talk(PP,"A TROLL") \ RETURN 5100 RUN Talk(PP,"ONE OF THE UNDEAD") \ RETURN 5110 RUN Talk(PP,"A GIANT SNAKE") \ RETURN 8000 FOR Y=0 TO 21 \ FOR X=0 TO 21IF a(X,Y)=1 THEN PRINT cw$; ELSE IF X=PX AND Y=PY THEN PRINT lo$; ELSE PRINT bl$; ENDIF ENDIF NEXT X \ PRINT  \NEXT Y8010 RUN Talk(PP+1,"KILL POINTS ARE "+STR$(FIX(KP)))RUN Talk(PP+1,"TRY IT AGAIN?  ENTER Y OR N")8020 INPUT a$IF a$="Y" OR a$="y" THEN 10IF a$<>"N" AND a$<>"n" THEN 8020IF PP>1 THEN SHELL "unlink ssc sscpak"ENDIF END DATA 7,0,5,-2,-5,5,12,8,4,2,4,0,0DATA -5,3,3,0,1,1,-4,-8,12,0,12,-5DATA 0,12,12,6,5,2,4,-1,-2,-7PROCEDURE TalkPARAM PP:INTEGERPARAM in:STRING[80]DIM ssc:INTEGERDIM device_name:STRING[4]DIM c:INTEGERdevice_name:="/SSC"IF PP<2 OR PP>2 THEN IF LEFT$(in,1)=" " THEN PRINT RIGHT$(in,LEN(in)-1)ELSE PRINT inENDIF ENDIF RUN check(in,"BROAD","BROD")IF PP>1 THEN OPEN #ssc,device_name:WRITERUN check(in,"WEAPON","WEPON")RUN check(in,"TRY","TRI")RUN check(in,"ONE","WON")RUN check(in,"PROGRAM","PRO GRAM")RUN check(in,"LOSE","LOOSE")RUN check(in,"GIANT","GI ANT")RUN check(in,"LOST","LOSTE")PRINT #ssc,inCLOSE #sscENDIF END PROCEDURE CheckPARAM a$:STRING[80]PARAM b$:STRING[80]PARAM c$:STRING[80]DIM l:INTEGERDIM i:INTEGERl=LEN(b$)i=SUBSTR(b$,a$)IF i>0 THEN a$=LEFT$(a$,i-1)+c$+RIGHT$(a$,LEN(a$)-(i+l-1))ENDIF END PROCEDURE CLSPARAM PP:INTEGERIF PP<2 OR PP>2 THEN PRINT CHR$(12); ENDIF END PROCEDURE PNPARAM PP:INTEGERIF PP<2 OR PP>2 THEN PRINT ENDIF END PROCEDURE SlowdownPARAM PP:INTEGERIF PP<2 THEN RUN Wait(180)ENDIF END PROCEDURE WaitPARAM delay:INTEGERTYPE registers=rcc,ra,rb,rdp:BYTE; rx,ry,ru:INTEGERDIM regs:registersregs.rx=delayRUN Syscall($0A,regs)END 