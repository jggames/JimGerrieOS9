PROCEDURE CNPokerBASE 0DIM cl,de,dr,ha,hs,j,k,nd,no,pd:INTEGERDIM q,re,su,t,wi,x,z,bet:INTEGERDIM be(3),po(3),pa(3),ga(3),th(3),sr(3),fo(3),fl(3),hi(4):INTEGERDIM jb$,hcard$,suit$,line$,result$:STRING[32]DIM card(7,4):INTEGERDIM cc$(6,4):STRING[2]DIM c1$(6),c2$(6),c3$(6),c4$(6),c5$(6):STRING[6]DIM a$,hisuit$:STRING[2]DIM deck$(53):STRING[2]DIM co(5):INTEGERbet=RND(-(VAL(RIGHT$(DATE$,2))))FOR t=0 TO 6 \ FOR x=0 TO 3card(t,x)=0NEXT xNEXT tco(1)=32co(2)=48co(3)=48co(4)=32FOR t=0 TO 2po(t)=0pa(t)=0ga(t)=0th(t)=0fl(t)=0sr(t)=0fo(t)=0hi(t)=0NEXT thi(3)=0FOR t=0 TO 5c1$(t)=""c2$(t)=""c3$(t)=""c4$(t)=""c5$(t)=""NEXT tline$=""FOR t=1 TO 32line$=line$+CHR$(160)NEXT t100 FOR t=0 TO 51READ a$NEXT tGOSUB 7000105 jb$="CN! Poker"110 nd=2be(1)=5be(2)=5130 de=1pd=14150 DATA "AC","2C","3C","4C","5C","6C"DATA "7C","8C","9C","TC","JC","QC","KC"160 DATA "AS","2S","3S","4S","5S","6S"DATA "7S","8S","9S","TS","JS","QS","KS"170 DATA "AH","2H","3H","4H","5H","6H","7H"DATA "8H","9H","TH","JH","QH","KH"180 DATA "AD","2D","3D","4D","5D","6D","7D"DATA "8D","9D","TD","JD","QD","KD"190 suit$="23456789TJQKA"200 FOR x=1 TO 5cc$(x,3)=CHR$(207)NEXT x220 FOR x=1 TO 52deck$(x)=""NEXT x225 GOSUB 9100230 po(1)=500po(2)=500240 REM ** MAIN PROGRAM **250 GOSUB 570260 GOSUB 640270 GOSUB 1890GOSUB 1950280 GOSUB 700290 GOSUB 810310 RUN PRINTAT(485)PRINT "Another hand (y/n)?"; 320 RUN INKEY(a$)IF a$="" THEN 320330 IF a$="N" OR a$="n" THEN 360340 IF a$="Y" OR a$="y" THEN 240PRINT CHR$(8); 350 GOTO 320360 PRINT CHR$(12); 370 PRINT "THANKS FOR THE GAME.  COME BACK REAL SOON NOW YA HEAR!"380 END 390 REM ** SHUFFLE DECK **400 RESTORE 410 FOR x=0 TO 51420 READ deck$(x)430 NEXT x440 RETURN 450 PRINT CHR$(12); 460 REM CLEAR SCREENFOR t=1 TO 14PRINT line$; NEXT t470 RETURN 480 REM ** DEAL ONE HAND **500 FOR x=1 TO 5510 GOSUB 9300GOSUB 9400520 RUN PRINTAT(cl)FOR t=1 TO 5PRINT RIGHT$(c4$(su),1); NEXT tRUN PRINTAT(cl)PRINT cd$; 530 RUN PRINTAT(cl+32)PRINT c1$(su); 540 RUN PRINTAT(cl+64)PRINT c2$(su); 550 RUN PRINTAT(cl+96)PRINT c3$(su); 555 RUN PRINTAT(cl+128)PRINT c4$(su); 558 RUN PRINTAT(cl+128+(5-LEN(cd$)))PRINT cd$; 560 IF LEN(cd$)>2 AND su=4 THEN RUN PRINTAT(cl+128)PRINT CHR$(191); CHR$(191); CHR$(179); CHR$(191); LEFT$(cd$,1); ENDIF cl=cl+6NEXT xIF ha=2 AND k<2 THEN z=49FOR t=1 TO 5RUN PRINTAT(381+t*6)PRINT t; NEXT tENDIF 565 RETURN 570 REM ** PRINT HANDS **580 GOSUB 390GOSUB 450590 FOR x=1 TO 5600 ha=1cl=33GOSUB 2010610 ha=2k=1cl=225GOSUB 2010620 NEXT x630 RETURN 640 re=0650 result$=jb$GOSUB 9500660 IF de=1 THEN ha=3cl=33GOSUB 480ENDIF 670 IF de=0 THEN ha=1cl=33GOSUB 1070ENDIF 680 ha=2cl=225GOSUB 1070GOSUB 480690 RETURN 700 REM ** GET CARD TO TRASH **710 k=1WHILE k<3 DO 730 RUN PRINTAT(448)PRINT "Hit card no. to trash or ENTER"; 735 RUN INKEY(a$)IF a$="" THEN 735IF a$=CHR$(13) THEN 790IF ASC(a$)<49 OR ASC(a$)>53 THEN PRINT CHR$(8); GOTO 735ENDIF 740 x=VAL(a$)750 GOSUB 450770 ha=2GOSUB 2010780 GOSUB 640790 k=k+1ENDWHILE 800 RUN PRINTAT(448)FOR t=1 TO 32 \ PRINT CHR$(32);  \NEXT tre=448result$=" Press <C> to see hands "GOSUB 9500801 RUN INKEY(a$)IF a$="" THEN 801IF a$<>"c" AND a$<>"C" THEN PRINT CHR$(8); GOTO 801ENDIF 805 RETURN 810 GOSUB 450820 re=0result$=jb$GOSUB 9500830 GOSUB 1630840 ha=1GOSUB 1070cl=33GOSUB 480850 GOSUB 900re=192GOSUB 9500860 ha=2GOSUB 1070cl=225GOSUB 480870 GOSUB 900re=384GOSUB 9500880 GOSUB 1490890 RETURN 900 REM ** CHECK HAND **910 hi(ha)=0920 GOSUB 1070930 GOSUB 1160GOSUB 1220GOSUB 1280GOSUB 1340GOSUB 1400940 result$="GARBAGE"ga(ha)=0950 IF pa(ha)>0 THEN result$=STR$(pa(ha))+" PAIR"ga(ha)=pa(ha)ENDIF 960 IF th(ha)=1 THEN result$="THREE OF A KIND"ga(ha)=3ENDIF 970 IF sr(ha)=1 THEN result$="STRAIGHT"ga(ha)=4ENDIF 980 IF fl(ha)=1 THEN result$="FLUSH"ga(ha)=5ENDIF 990 IF pa(ha)=1 AND th(ha)=1 THEN result$="FULL HOUSE"ga(ha)=6ENDIF 1000 IF fo(ha)=1 THEN result$="FOUR OF A KIND"ga(ha)=7ENDIF 1010 IF fl(ha)=1 AND sr(ha)=1 THEN result$="STRAIGHT FLUSH"ga(ha)=8ENDIF 1020 IF fl(ha)=1 AND sr(ha)=1 AND hi(ha)=13 THEN result$="ROYAL FLUSH"ga(ha)=9ENDIF 1030 GOSUB 40501035 IF hi(ha)=0 THEN GOSUB 4000 \ ENDIF 1040 REM ** FIND HI CARD **1050 result$=result$+" "+hcard$+" HIGH"1060 RETURN 1070 REM ** SEARCH HAND **1080 FOR x=1 TO 51090 GOSUB 30001100 NEXT x1110 z=0FOR x=1 TO 41120 IF card(x,ha)>card(x+1,ha) THEN hs=card(x,ha)card(x,ha)=card(x+1,ha)card(x+1,ha)=hshisuit$=cc$(x,ha)cc$(x,ha)=cc$(x+1,ha)cc$(x+1,ha)=hisuit$z=1ENDIF 1130 NEXT x1140 IF z=1 THEN 11101150 RETURN 1160 REM 1170 pa(ha)=01180 FOR x=1 TO 41190 IF card(x,ha)<>card(x-1,ha) AND card(x,ha)=card(x+1,ha) AND
card(x,ha)<>card(x+2,ha) THEN pa(ha)=pa(ha)+1IF hi(ha)<card(x,ha) THEN hi(ha)=card(x,ha)ENDIF ENDIF 1200 NEXT x1210 RETURN 1220 REM ** SORT HAND **1230 th(ha)=01240 FOR x=1 TO 31250 IF card(x,ha)<>card(x-1,ha) AND card(x,ha)=card(x+1,ha) AND
card(x,ha)=card(x+2,ha) AND card(x,ha)<>card(x+3,ha) THEN 1270 th(ha)=1IF hi(ha)<card(x,ha) THEN hi(ha)=card(x,ha)ENDIF ENDIF NEXT x1275 RETURN 1280 REM ** FIND 4 OF A KIND **1290 fo(ha)=01300 FOR x=1 TO 21310 IF card(x,ha)=card(x+1,ha) AND card(x,ha)=card(x+2,ha) AND card
(x,ha)=card(x+3,ha) THEN fo(ha)=1IF hi(ha)<card(x,ha) THEN hi(ha)=card(x,ha)ENDIF ENDIF 1320 NEXT x1330 RETURN 1340 REM ** SORT HAND **1350 sr(ha)=11360 FOR x=1 TO 41370 IF card(x,ha)+1<>card(x+1,ha) THEN sr(ha)=0ENDIF 1380 NEXT x1390 RETURN 1400 REM ** FIND FLUSH **1410 fl(ha)=11420 FOR x=2 TO 51430 IF RIGHT$(cc$(1,ha),1)<>RIGHT$(cc$(x,ha),1) THEN fl(ha)=0ENDIF 1440 NEXT x1450 RETURN 1490 REM ** DISPLAY WINNER **1500 wi=01510 IF ga(1)>ga(2) THEN wi=1 \ ENDIF 1520 IF ga(2)>ga(1) THEN wi=2 \ ENDIF 1530 IF wi<>0 THEN 15601540 IF hi(1)>hi(2) THEN wi=1 \ ENDIF 1550 IF hi(2)>hi(1) THEN wi=2 \ ENDIF 1560 IF wi=1 THEN win$="I WIN!  PAY UP HOMBRE."po(1)=po(1)+be(2)po(2)=po(2)-be(2)ENDIF 1570 IF wi=2 THEN win$="YOU WIN...  YA VARMINT!"po(2)=po(2)+be(1)po(1)=po(1)-be(1)ENDIF 1580 IF wi=0 THEN win$="DRAW. ALL BETS CARRIED..."ENDIF 1590 re=416result$=win$GOSUB 95001595 re=447result$="YOUR POT: $"+STR$(po(2))+"  MY POT: $"+STR$(po(1))GOSUB 9500PRINT 1596 IF po(2)<1 THEN PRINT "SORRY BUDDY YOU'RE OUT OF MONEY."GOTO 370ENDIF 1597 IF po(1)<1 THEN PRINT "SORRY I AM OUT OF CASH. I'LL PAYYOU BACK NEXT THURSDAY OK."PRINT GOTO 370ENDIF 1610 be(1)=5be(2)=51620 RETURN 1630 REM 1640 dr=01650 dr=dr+1IF dr>nd THEN 18801660 ha=11670 GOSUB 10701680 GOSUB 1400IF fl(ha)=1 THEN 18801690 GOSUB 1340IF sr(ha)=1 THEN 18801700 GOSUB 1280IF fo(ha)=1 THEN 18801710 hi(ha)=0GOSUB 12201720 IF th(ha)=0 THEN 17801730 GOSUB 1160IF pa(ha)=1 THEN 18801740 x=11750 WHILE card(x,ha)=hi(ha) DO x=x+1ENDWHILE 1760 GOSUB 20101770 GOSUB 1070GOTO 16501780 REM 1790 GOSUB 11601800 IF pa(ha)=0 THEN x=1GOSUB 2010GOTO 1650ENDIF 1810 IF pa(ha)=2 THEN 18501820 x=11830 IF card(x,ha)=hi(ha) THEN x=x+1GOTO 1830ENDIF 1840 GOSUB 2010GOTO 16501850 IF card(1,ha)<>card(2,ha) THEN x=1GOSUB 2010GOTO 1650ENDIF 1860 IF card(5,ha)<>card(4,ha) THEN x=5GOSUB 2010GOTO 1650ENDIF 1870 x=3GOSUB 2010GOTO 16501880 RETURN 1890 REM ** GET COMPUTER'S BET **1900 ha=11910 GOSUB 9001920 be(ha)=be(ha)+10*ga(ha)+(INT(RND(20))+1)IF be(ha)>105 THEN be(ha)=INT(RND(50))+56 \ ENDIF IF be(ha)<15 THEN be(ha)=be(ha)+10 \ ENDIF 1930 RUN PRINTAT(449)PRINT "I BET $"; be(ha)-5; 1940 RETURN 1950 REM ** GET PLAYER'S BET **1960 ha=21970 RUN PRINTAT(462)INPUT "YOUR BET? ",betIF bet>100 THEN RUN PRINTAT(481)PRINT "*******SORRY $100 LIMIT*******"; GOTO 1970ENDIF IF bet<0 THEN 19701980 be(ha)=be(ha)+bet1990 be(1)=be(2)2000 RETURN 2010 REM 2020 j=INT(RND(52))2025 IF deck$(j)="XX" THEN 20202030 cc$(x,ha)=deck$(j)deck$(j)="XX"2040 RETURN 3000 REM 3010 IF LEFT$(cc$(x,ha),1)="2" THEN card(x,ha)=2 \ ENDIF 3020 IF LEFT$(cc$(x,ha),1)="3" THEN card(x,ha)=3 \ ENDIF 3030 IF LEFT$(cc$(x,ha),1)="4" THEN card(x,ha)=4 \ ENDIF 3040 IF LEFT$(cc$(x,ha),1)="5" THEN card(x,ha)=5 \ ENDIF 3050 IF LEFT$(cc$(x,ha),1)="6" THEN card(x,ha)=6 \ ENDIF 3060 IF LEFT$(cc$(x,ha),1)="7" THEN card(x,ha)=7 \ ENDIF 3070 IF LEFT$(cc$(x,ha),1)="8" THEN card(x,ha)=8 \ ENDIF 3080 IF LEFT$(cc$(x,ha),1)="9" THEN card(x,ha)=9 \ ENDIF 3090 IF LEFT$(cc$(x,ha),1)="T" THEN card(x,ha)=10 \ ENDIF 3100 IF LEFT$(cc$(x,ha),1)="J" THEN card(x,ha)=11 \ ENDIF 3110 IF LEFT$(cc$(x,ha),1)="Q" THEN card(x,ha)=12 \ ENDIF 3120 IF LEFT$(cc$(x,ha),1)="K" THEN card(x,ha)=13 \ ENDIF 3130 IF LEFT$(cc$(x,ha),1)="A" THEN card(x,ha)=14 \ ENDIF 3140 RETURN 4000 REM 4010 FOR x=1 TO 54020 IF card(x,ha)>card(x+1,ha) THEN hi(ha)=card(x,ha)ELSE 4030 hi(ha)=card(x+1,ha)ENDIF 4040 NEXT x4050 IF hi(ha)=14 THEN hcard$="ACES" \ ENDIF 4060 IF hi(ha)=13 THEN hcard$="KINGS" \ ENDIF 4070 IF hi(ha)=12 THEN hcard$="QUEENS" \ ENDIF 4080 IF hi(ha)=11 THEN hcard$="JACKS" \ ENDIF 4090 IF hi(ha)<11 AND hi(ha)>0 THEN hcard$=STR$(hi(ha))+"S" \ ENDIF
4095 RETURN 7000 PRINT CHR$(12); 7010 re=0result$="CN! Poker"GOSUB 9500PRINT PRINT 7020 PRINT " PLAYING POKER WITH A COMPUTER   HAS ITS ADVANTAGES. IT DOESN'T  CHEAT, IT DOESN'T TRY TO READ"7030 PRINT " YOUR FACE AND IF YOU FIND       YOURSELF IN THE HOLE TO IT,YOU  CAN SHUT IT OFF. HERE'S A BYTE"7040 PRINT " OF SOFTWARE TO DEAL YOUR        SYSTEM. YOU START WITH $500.00"7050 PRINT " THERE'S A $5 ANTE."re=384result$="By Steve Rimmer 1984"GOSUB 9500re=416result$="OS9 Edits by Jim Gerrie"GOSUB 9500PRINT PRINT PRINT "     Press any key to begin"; 7080 RUN INKEY(a$)IF a$="" THEN 7080PRINT CHR$(8); RETURN 7095 REM ** CARD DATA **9100 DATA 14,0,12,0,139110 DATA 11,0,0,0,79120 DATA 15,11,0,7,159125 DATA 15,15,15,15,159130 DATA 15,14,0,13,159140 DATA 14,0,0,0,139150 DATA 11,3,0,3,79155 DATA 15,15,15,15,159160 DATA 15,14,0,13,159170 DATA 14,4,0,8,139180 DATA 15,7,0,11,159185 DATA 15,15,15,15,159200 DATA 15,14,0,13,159210 DATA 14,0,0,0,139220 DATA 15,2,0,1,159230 DATA 15,15,3,15,159235 c1$(5)=CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)9240 c2$(5)=CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)9245 c3$(5)=CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)9250 c4$(5)=CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)+CHR$(207)9255 FOR t=1 TO 49260 FOR q=1 TO 5READ noc1$(t)=c1$(t)+CHR$(144+no+co(t))NEXT q9270 FOR q=1 TO 5READ noc2$(t)=c2$(t)+CHR$(144+no+co(t))NEXT q9275 FOR q=1 TO 5READ noc3$(t)=c3$(t)+CHR$(144+no+co(t))NEXT q9280 FOR q=1 TO 5READ noc4$(t)=c4$(t)+CHR$(144+no+co(t))NEXT q9285 NEXT t9290 RETURN 9300 REM 9310 IF RIGHT$(cc$(x,ha),1)="H" THEN su=1 \ ENDIF 9320 IF RIGHT$(cc$(x,ha),1)="S" THEN su=2 \ ENDIF 9330 IF RIGHT$(cc$(x,ha),1)="C" THEN su=3 \ ENDIF 9340 IF RIGHT$(cc$(x,ha),1)="D" THEN su=4 \ ENDIF 9350 IF ha=3 THEN su=5 \ ENDIF 9355 RETURN 9400 cd$=LEFT$(cc$(x,ha),1)9410 IF LEFT$(cc$(x,ha),1)="K" THEN cd$="K" \ ENDIF 9420 IF LEFT$(cc$(x,ha),1)="Q" THEN cd$="Q" \ ENDIF 9430 IF LEFT$(cc$(x,ha),1)="J" THEN cd$="J" \ ENDIF 9440 IF LEFT$(cc$(x,ha),1)="T" THEN cd$="10" \ ENDIF 9445 IF LEFT$(cc$(x,ha),1)="A" THEN cd$="A" \ ENDIF 9460 RETURN 9500 REM ** PRINT OUTCOME **t=INT((32-LEN(result$))/2)9520 RUN PRINTAT(re+t)PRINT result$; 9540 RETURN PROCEDURE PrintatPARAM locate:INTEGERDIM cl:REALcl=FLOAT(locate)DIM col,row:INTEGERrow=INT(cl/32)col=INT(MOD(cl,32))PRINT CHR$(2); CHR$(col+32); CHR$(row+32); END 