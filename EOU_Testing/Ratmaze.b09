PROCEDURE RatmazeBASE 0DIM MZ(14,11):INTEGERDIM V,H,CV,CH,SV,SH,RV,RH:INTEGERDIM a$:STRING[1]DIM T:REALT=RND(-(VAL(RIGHT$(DATE$,2))))GOTO 20020 RUN GFX("LINE",0,0,24,16)RUN GFX("LINE",24,174)RUN GFX("LINE",0,190)RETURN 22 RUN GFX("LINE",0,16,24,16)RUN GFX("LINE",24,16,24,174)RUN GFX("LINE",0,174,24,174)RETURN 24 RUN GFX("LINE",254,0,230,16)RUN GFX("LINE",230,174)RUN GFX("LINE",254,190)RETURN 26 RUN GFX("LINE",230,16,254,16)RUN GFX("LINE",230,16,230,174)RUN GFX("LINE",230,174,254,174)RETURN 28 RUN GFX("LINE",24,16,230,16)RUN GFX("LINE",230,174)RUN GFX("LINE",24,174)RUN GFX("LINE",24,16)RETURN 30 RUN GFX("LINE",24,16,80,50)RUN GFX("LINE",80,140)RUN GFX("LINE",24,174)RETURN 32 RUN GFX("LINE",24,50,80,50)RUN GFX("LINE",80,140)RUN GFX("LINE",24,140)RUN GFX("LINE",24,50)RETURN 34 RUN GFX("LINE",230,16,174,50)RUN GFX("LINE",174,140)RUN GFX("LINE",230,174)RETURN 36 RUN GFX("LINE",174,50,230,50)RUN GFX("LINE",230,140)RUN GFX("LINE",174,140)RUN GFX("LINE",174,50)RETURN 38 RUN GFX("LINE",80,50,174,50)RUN GFX("LINE",174,140)RUN GFX("LINE",80,140)RUN GFX("LINE",80,50)RETURN 40 RUN GFX("LINE",80,50,116,74)RUN GFX("LINE",116,116)RUN GFX("LINE",80,140)RETURN 42 RUN GFX("LINE",80,74,116,74)RUN GFX("LINE",116,116)RUN GFX("LINE",80,116)RUN GFX("LINE",80,74)RETURN 44 RUN GFX("LINE",174,50,138,74)RUN GFX("LINE",138,116)RUN GFX("LINE",174,140)RETURN 46 RUN GFX("LINE",138,74,174,74)RUN GFX("LINE",174,116)RUN GFX("LINE",138,116)RUN GFX("LINE",138,74)RETURN 48 RUN GFX("LINE",116,74,138,74)RUN GFX("LINE",138,116)RUN GFX("LINE",116,116)RUN GFX("LINE",116,74)RETURN 50 RUN GFX("LINE",116,74,126,80)RUN GFX("LINE",126,110)RUN GFX("LINE",116,116)RETURN 52 RUN GFX("LINE",116,80,126,80)RUN GFX("LINE",126,110)RUN GFX("LINE",116,110)RUN GFX("LINE",116,80)RETURN 54 RUN GFX("LINE",138,74,128,80)RUN GFX("LINE",128,110)RUN GFX("LINE",138,116)RETURN 56 RUN GFX("LINE",128,80,138,80)RUN GFX("LINE",138,110)RUN GFX("LINE",128,110)RUN GFX("LINE",128,80)58 RETURN 60 ON SEX GOTO 62,64,6662 RUN GFX("line",118,30,136,30)RUN GFX("line",127,16)RUN GFX("line",118,30)RETURN 64 RUN GFX("line",122,66,132,66)RUN GFX("line",127,56)RUN GFX("line",122,66)RETURN 66 RUN GFX("LINE",124,80,130,80)RUN GFX("LINE",127,74)RUN GFX("LINE",124,80)RETURN 70 FL=0FOR X=-1 TO 1 STEP 272 IF MZ(H+X,V)<=0 THEN MZ(H+X,V)=-1FL=1ENDIF 74 IF MZ(H,V+X)<=0 THEN MZ(H,V+X)=-1FL=1ENDIF 76 NEXT XRETURN 80 DR=INT(RND(0)*4)+1ON DR GOTO 82,84,86,8882 IF MZ(H-1,V)=-1 THEN NH=H-1NV=VMZ(NH,NV)=4MZ(H,V)=MZ(H,V)+1RETURN ELSE GOTO 80ENDIF 84 IF MZ(H,V-1)=-1 THEN NH=HNV=V-1MZ(NH,NV)=8MZ(H,V)=MZ(H,V)+2RETURN ELSE GOTO 80ENDIF 86 IF MZ(H+1,V)=-1 THEN NH=H+1NV=VMZ(NH,NV)=1MZ(H,V)=MZ(H,V)+4RETURN ELSE GOTO 80ENDIF 88 IF MZ(H,V+1)=-1 THEN NH=HNV=V+1MZ(NH,NV)=2MZ(H,V)=MZ(H,V)+8RETURN ELSE GOTO 80ENDIF 90 FL=0FOR X=12 TO 1 STEP -1FOR Y=1 TO 992 IF MZ(X,Y)>=0 THEN 9693 FL=FL+1FOR I=-1 TO 1 STEP 2IF MZ(X+I,Y)>0 AND MZ(X+I,Y)<100 THEN NH=X+INV=YENDIF 94 IF MZ(X,Y+I)>0 AND MZ(X,Y+I)<100 THEN NH=XNV=Y+IENDIF 95 NEXT I96 NEXT YNEXT XRETURN 100 ON SEX GOSUB 20,30,40,50RETURN 102 ON SEX GOSUB 22,32,42,52RETURN 104 ON SEX GOSUB 24,34,44,54RETURN 106 ON SEX GOSUB 26,36,46,56RETURN 108 ON SEX GOSUB 28,38,48,58FL=1RETURN 200 FOR H=0 TO 13MZ(H,0)=100MZ(H,10)=100NEXT HFOR V=0 TO 10MZ(0,V)=100MZ(13,V)=100NEXT V210 GOSUB 1600PRINT "            Rat Maze"PRINT 220 PRINT "       Ben Brunotte 1985"PRINT "  OS9 edits by Jim Gerrie 1996"PRINT 230 PRINT "Do you need instructions?"235 INPUT "(y or n) ",a$270 IF a$="y" OR a$="Y" THEN 1500IF a$<>"N" AND a$<>"n" THEN 235300 GOSUB 1600PRINT "Please wait..."FOR H=1 TO 12FOR V=1 TO 9MZ(H,V)=0NEXT VNEXT HH=INT(RND(0)*12)+1V=INT(RND(0)*9)+1MZ(H,V)=16GOSUB 70GOSUB 80MZ(H,V)=MZ(H,V)-16310 H=NHV=NVGOSUB 70IF FL=0 THEN 330320 GOSUB 80GOTO 310330 GOSUB 90IF FL=0 THEN 410GOTO 310410 SV=INT(RND(0)*9)+1SH=1CV=INT(RND(0)*9)+1CH=12420 RH=SHRV=SVDR=INT(RND(0)*4)+1500 RUN GFX("MODE",0,1)RUN GFX("CLEAR",0)SEX=1Z=MZ(RH,RV)FL=0IF CH=RH AND CV=RV THEN 1300510 ON Z GOTO 520,530,540,550,560,570,580,590,600,610,620,630,640 ,650,770520 ON DR GOTO 720,710,700,730530 ON DR GOTO 730,720,710,700540 ON DR GOTO 750,740,710,730550 ON DR GOTO 700,730,720,710560 ON DR GOTO 720,760,720,760570 ON DR GOTO 730,750,740,710580 ON DR GOTO 750,770,740,760590 ON DR GOTO 710,700,730,720600 ON DR GOTO 740,710,730,750610 ON DR GOTO 760,720,760,720620 ON DR GOTO 770,740,760,750630 ON DR GOTO 710,730,750,740640 ON DR GOTO 740,760,750,770650 ON DR GOTO 760,750,770,740700 GOSUB 100GOSUB 104GOSUB 108GOTO 800710 GOSUB 102GOSUB 104GOSUB 108GOTO 800720 GOSUB 100GOSUB 104GOTO 800730 GOSUB 100GOSUB 106GOSUB 108GOTO 800740 GOSUB 102GOSUB 104GOTO 800750 GOSUB 100GOSUB 106GOTO 800760 GOSUB 102GOSUB 106GOSUB 108GOTO 800770 GOSUB 102GOSUB 106GOTO 800800 IF FL=1 OR SEX=4 THEN 900810 ON DR GOTO 820,830,840,850820 Z=MZ(RH-SEX,RV)IF CH=RH-SEX AND CV=RV THEN GOSUB 60ENDIF 825 GOTO 860830 Z=MZ(RH,RV-SEX)IF CH=RH AND CV=RV-SEX THEN GOSUB 60ENDIF 835 GOTO 860840 Z=MZ(RH+SEX,RV)IF CH=RH+SEX AND CV=RV THEN GOSUB 60ENDIF 845 GOTO 860850 Z=MZ(RH,RV+SEX)IF CH=RH AND CV=RV+SEX THEN GOSUB 60ENDIF 860 SEX=SEX+1GOTO 510900 IF ABS(CH-RH)>ABS(CV-RV) THEN Z=ABS(CH-RH)ELSE Z=ABS(CV-RV)ENDIF 910 REM 920 REM 930 REM 940 RUN inkey(a$)IF a$="" THEN 940950 IF a$=CHR$(8) THEN 1000960 IF a$=CHR$(9) THEN 1010970 IF a$=CHR$(12) THEN 1020980 IF a$="Q" OR a$="q" THEN GOTO 1200ENDIF IF a$=" " THEN GOSUB 1600PRINT "Distance to cheese = "; ZPRINT "Press any key to continue."999 RUN inkey(a$)IF a$="" THEN 999RUN GFX("MODE",0,1)ENDIF GOTO 9301000 DR=DR-1IF DR<=0 THEN DR=4ENDIF 1005 GOTO 5001010 DR=DR+1IF DR>=5 THEN DR=1ENDIF 1015 GOTO 5001020 Z=MZ(RH,RV)ON Z GOTO 1030,1040,1050,1060,1070,1080,1090,1100,1110,1120,1130 ,1140,1150,1160,11701030 IF DR=1 THEN 1170GOTO 9301040 IF DR=2 THEN 1170GOTO 9301050 IF DR<=2 THEN 1170GOTO 9301060 IF DR=3 THEN 1170GOTO 9301070 ON DR GOTO 1170,930,1170,9301080 ON DR GOTO 930,1170,1170,9301090 IF DR=4 THEN 930GOTO 11701100 IF DR=4 THEN 1170GOTO 9301110 ON DR GOTO 1170,930,930,11701120 ON DR GOTO 930,1170,930,11701130 IF DR=3 THEN 930GOTO 11701140 IF DR>=3 THEN 1170GOTO 9301150 IF DR=2 THEN 930GOTO 11701160 IF DR=1 THEN 9301170 IF DR=1 THEN RH=RH-1ENDIF 1172 IF DR=2 THEN RV=RV-1ENDIF 1174 IF DR=3 THEN RH=RH+1ENDIF 1176 IF DR=4 THEN RV=RV+1ENDIF 1180 GOTO 5001200 RUN GFX("clear",0)1205 RUN GFX("line",0,ABS(180-192),0,ABS(0-192))RUN GFX("LINE",240,ABS(0-192))FOR H=1 TO 12FOR V=1 TO 9Z=MZ(H,V)1210 REM ON Z GOTO 1220,1220,1220,1230,1230,1230,1230,1240,1240,1240,1240 ,1250,1250,1250,12501220 RUN GFX("LINE",20*H-20,ABS(20*V-192),20*H,ABS(20*V-192))RUN GFX("LINE",20*H,ABS(20*V-20-192))GOTO 12501230 RUN GFX("LINE",20*H-20,ABS(20*V-192),20*H,ABS(20*V-192))GOTO 12501240 RUN GFX("LINE",20*H,ABS(20*V-192),20*H,ABS(20*V-20-192))1250 NEXT VNEXT HRUN GFX("CIRCLE",20*CH-10,ABS(20*CV-10-192),6)1260 RUN GFX("LINE",20*SH,ABS(20*SV-20-192),20*SH-20,ABS(20*SV-192 ))RUN GFX("LINE",20*SH,ABS(20*SV-192),20*SH-20,ABS(20*SV-20-192))1270 RUN GFX("LINE",20*RH-4,ABS(20*RV-4-192),20*RH-16,ABS(20*RV- 4-192))RUN GFX("LINE",20*RH-16,ABS(20*RV-16-192))RUN GFX("LINE",20*RH-4,ABS(20*RV-16-192))RUN GFX("LINE",20*RH-4,ABS(20*RV-4-192))1280 RUN GFX("LINE",20*RH-4,ABS(20*RV-4-192),20*RH-16,ABS(20*RV- 16-192))RUN GFX("LINE",20*RH-4,ABS(20*RV-16-192),20*RH-16,ABS(20*RV-4-192 ))1290 RUN inkey(a$)IF a$="" THEN 1290GOSUB 1600GOTO 14001300 GOSUB 1600PRINT "      YOU GOT THE CHEESE!"FOR I=64 TO 16 STEP -8POKE 65314.,INT(I)FOR T=1 TO 500 \NEXT TNEXT I1400 PRINT INPUT "S=same, N=new or Q=quit maze? ",a$1420 IF a$="S" OR a$="s" THEN 4201430 IF a$="N" OR a$="n" THEN 3001440 IF a$="Q" OR a$="q" THEN RUN GFX("QUIT")END ENDIF GOTO 14001500 GOSUB 1600PRINT "     *** R A T  M A Z E ***"PRINT 1505 PRINT "You have a rat's eye view of"PRINT "the maze.  Press <SPACE> to see the number of steps to the"PRINT "cheese as the flea flies."PRINT 1510 PRINT " Your other options are:"PRINT " Right arrow=Turn right."PRINT " Left arrow=Turn left."PRINT " Up arrow=Move forward."PRINT " Q = Quit and see maze."1525 PRINT INPUT "Hit <ENTER> to Begin ",a$GOTO 3001600 RUN GFX("ALPHA")PRINT CHR$(12); POKE 65314.,16RETURN 