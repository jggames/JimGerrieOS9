PROCEDURE sttr1DIM G(8,8),KL(9,3),Q(8,8),R(6):INTEGERDIM NDF$(7):STRING[1]DIM A2$(7):STRING[16]DIM K9,K0,K,P,T,T0,T9,lv:INTEGERDIM temp,E,J,I,Q1,Q2:REALDIM A6$:STRING[32]temp=RND(-(VAL(RIGHT$(DATE$,2))))cs=12100 PRINT CHR$(cs)PRINT TAB(cs); "STAR TREK"PRINT INPUT "Enter level of difficulty (1-10)? ",lvIF lv<1 OR lv>10 THEN 100FOR I=1 TO 6R(I)=0NEXT INDF$(1)="."NDF$(2)="E"NDF$(3)="K"NDF$(4)="B"NDF$(5)="*"NDF$(6)="t"NDF$(7)="X"R3=INT(RND(0)*8)+1R4=INT(RND(0)*8)+1RM=0T1=INT(RND(0)*8)+1T2=INT(RND(0)*8)+1A2$(1)="Warp Engines"A2$(2)="S.R. Sensors"A2$(3)="L.R. Sensors"A2$(4)="Phasor Control"A2$(5)="Photon Tubes"A2$(6)="Damage Control"A6$="-------------------------------"T0=3000+INT(RND(0)*500)+1T=T0T9=T0+40E=3000P=10Q1=INT(RND(0)*8)+1Q2=INT(RND(0)*8)+1S1=INT(RND(0)*8)+1S2=INT(RND(0)*8)+1B9=0K9=0FOR I=1 TO 8FOR J=1 TO 8K3=0RL=RND(0)*100IF RL<.01 THEN K3=K3+1ENDIF IF RL<.1 THEN K3=K3+1ENDIF IF RL<.5 THEN K3=K3+1ENDIF IF RL<1 THEN K3=K3+1ENDIF IF RL<2 THEN K3=K3+1ENDIF IF RL<3 THEN K3=K3+1ENDIF IF RL<5 THEN K3=K3+1ENDIF IF RL<10 THEN K3=K3+1ENDIF K9=K9+K3B3=0IF RND(0)>.95 THEN B3=1 \ ENDIF B9=B9+B3S3=INT(RND(0)*8)+1G(I,J)=K3*100+B3*10+S3NEXT JNEXT IK0=K9IF B9>0 THEN GOTO 110ELSE I=INT(RND(0)*8)+1J=INT(RND(0)*8)+1G(I,J)=G(I,J)+10B9=1ENDIF 110 PRINT PRINT "Enter Secret code for possible" \ INPUT "use later: ",CO$PRINT 120 INPUT "Do you want your orders? ",A$B4=INT(RND(0)*8)+1B5=INT(RND(0)*8)+1G(B4,B5)=G(B4,B5)+10IF A$="Y" OR A$="y" THEN 150130 IF A$<>"N" AND A$<>"n" THEN 120PRINT CHR$(cs)GOTO 170140 INPUT "COMMAND (0-8)? ",IIF I<0 OR I>8 THEN 140F1=0I=I+1ON I GOTO 1530,290,1080,400,450,390,2400,880,160150 PRINT CHR$(cs)PRINT "Orders:","Stardate= "; T0PRINT A6$PRINT "Your mission is to rid the"PRINT "galaxy of the deadly Klingon"PRINT "menace.  To do this you must"PRINT "destroy the Klingon fleet of"PRINT K9; " battle cruisers."PRINT "You have 40 solar years to"PRINT "complete your mission"PRINT "(i.e. until stardate "; T9; ")"PRINT "The Enterprise is currently in:"GOSUB 9003PRINT A6$INPUT "Hit <CR> to begin your mission. ",A$GOTO 170160 INPUT "Abandon Mission? ",A$IF A$="Y" OR A$="y" THEN 1510GOTO 140170 K3=0B3=0S3=0TH=0X=0RM=0IF Q1<1 OR Q1>8 OR Q2<1 OR Q2>8 THEN 180K3=INT(G(Q1,Q2)/100)B3=INT((G(Q1,Q2)-K3*100)/10)S3=INT(G(Q1,Q2)-K3*100-B3*10)PRINT USING "3(I4,X5)"; K3,B3,S3IF T1=Q1 AND T2=Q2 THEN TH=INT(RND(0)*2)+3ENDIF FOR I=1 TO 9FOR J=1 TO 3KL(I,J)=0NEXT JNEXT I180 FOR I=1 TO 8FOR J=1 TO 8Q(I,J)=0NEXT JNEXT IQ(S1,S2)=1IF K3<1 THEN 190FOR I=1 TO K3GOSUB 280Q(R1,R2)=2KL(I,1)=R1KL(I,2)=R2KL(I,3)=200NEXT I190 IF B3<1 THEN 220200 FOR I=1 TO B3GOSUB 280Q(R1,R2)=3NEXT I210 IF B4=Q1 AND B5=Q2 THEN B6=R1B7=R2ENDIF 220 IF S3<1 THEN 240230 FOR I=1 TO S3GOSUB 280Q(R1,R2)=4NEXT I240 IF TH<1 THEN 260250 FOR I=1 TO THGOSUB 280Q(R1,R2)=5NEXT I260 IF RM=1 OR R3=Q1 AND R4=Q2 THEN RM=1GOSUB 280R3=R1R4=R2ENDIF 270 GOTO 290280 R1=INT(RND(0)*8)+1R2=INT(RND(0)*8)+1IF Q(R1,R2)<>0 THEN 280RETURN 290 FOR I=1 TO 3FOR J=1 TO 3IF S1+I-2<1 OR S1+I-2>8 OR S2+J-2<1 OR S2+J-2>8 THEN 330IF Q(S1+I-2,S2+J-2)<>3 THEN 330C$="DOCKED"E=3000P=10GOTO 320300 FOR DD=1 TO 6310 IF R(DD)<>0 THEN PRINT "** "; A2$(DD); " now fully" \ PRINT "repaired **" \ GOSUB
2720R(DD)=0ENDIF NEXT DDRETURN 320 IF S1+I-2=B6 AND S2+J-2=B7 THEN PRINT "The Enterprise has triggered" \ PRINT "a Klingon mine!"GOSUB 2720GOTO 1390ELSE GOSUB 300ENDIF IF K3>0 THEN PRINT "Starbase shields protect the" \ PRINT "Enterprise."ENDIF GOTO 370330 NEXT JNEXT IIF K3>0 OR RM=1 OR TH>1 THEN 340IF E<300 THEN 350C$="GREEN"GOTO 360340 C$="RED"F1=1GOTO 360350 C$="YELLOW"360 IF RM=1 THEN GOSUB 2650ENDIF IF TH>1 THEN GOSUB 2450ENDIF E=E-.5IF E<0 THEN 1390370 IF R(2)<>0 THEN PRINT CHR$(cs)PRINT "** Short Range Sensors out **"GOTO 140ENDIF PRINT CHR$(cs); PRINT " ** Short Range Sensor Scan **"PRINT A6$K=T9-TFOR I=1 TO 8FOR J=1 TO 8PRINT " "; NDF$(Q(I,J)+1); NEXT JON I GOSUB 9001,9002,9003,9004,9005,9006,9007,9008NEXT IPRINT A6$GOTO 140390 IF R(6)<>0 THEN PRINT "Damage report not available."GOTO 9015ENDIF PRINT CHR$(cs)PRINT " ** Damage Control Report **"PRINT "Device","State of repair"PRINT A6$J=0FOR I=1 TO 5J=J+R(I)IF R(I)<0 THEN PRINT A2$(I),R(I)ENDIF NEXT IIF J>=0 THEN PRINT "All systems operable."ENDIF PRINT A6$GOSUB 1350GOTO 140400 GOSUB 9009 \ IF R(4)<>0 THEN PRINT "Phasor Control is damaged."GOTO 9015ENDIF IF C$="DOCKED" THEN 9018PRINT "Phasors locked on target." \ PRINT "Energy available ="; PRINT USING "i5"; E-.5410 INPUT "UNITS TO FIRE? ",UIF U=0 THEN 140IF U<0 OR E-U<0 THEN 410E=E-UIF Q1=B4 AND Q2=B5 THEN IF U>499 THEN Q(B6,B7)=0GOSUB 9014GOSUB 2720ENDIF ENDIF IF TH<1 THEN 420WB=WB-UIF WB<0 THEN PRINT "Web disrupted!" \ PRINT "Tholians destroyed!"TH=0T1=-1FOR I=1 TO 8FOR J=1 TO 8IF Q(I,J)=5 OR Q(I,J)=6 THEN Q(I,J)=0ENDIF NEXT JNEXT IENDIF IF WB<0 THEN GOTO 9015ENDIF 420 FOR I=1 TO 9IF KL(I,3)<=0 THEN 430DI=ABS(KL(I,1)-S1)^2+ABS(KL(I,2)-S2)^2H=U/K3*(.5+.5*RND(0))/SQRT(DI)KL(I,3)=KL(I,3)-HGOSUB 9013PRINT "Klingon" \ PRINT "at sector "; KL(I,1); "-"; KL(I,2)IF KL(I,3)>0 THEN PRINT USING "i5>"; KL(I,3);  \ PRINT " units left"GOTO 430ENDIF GOSUB 9016Q(KL(I,1),KL(I,2))=0G(Q1,Q2)=K3*100+B3*10+S3IF K9<=0 THEN 1450430 NEXT I440 GOTO 9015450 GOSUB 9009 \ IF R(5)<>0 THEN PRINT "Photon tubes not operational."GOSUB 2720GOSUB 1350GOTO 140ENDIF 460 IF C$="DOCKED" THEN 9018470 IF P=0 THEN PRINT "All Torpedoes Expended."GOTO 9015ENDIF 480 INPUT "TORPEDO COURSE (1-8.9999)? ",C1490 IF C1=0 THEN 140500 IF C1<1 OR C1>8.9999 THEN 480510 X1=-(SIN((C1-1)*.785398))X2=COS((C1-1)*.785398)520 IF ABS(X1)>ABS(X2) THEN XY=ABS(X1)ELSE XY=ABS(X2)ENDIF 530 X=S1Y=S2P=P-1540 X=X+X1/XYY=Y+X2/XY550 IF X<.5 OR X>8.5 OR Y<.5 OR Y>8.5 THEN GOSUB 9009PRINT "Torpedo missed."GOTO 9015ENDIF L1=FIX(X) \L2=FIX(Y)IF cs=12 THEN PRINT CHR$(2); CHR$(31+L2*2); CHR$(33+L1); ""; FOR temp=1 TO 70 \NEXT tempPRINT CHR$(2); CHR$(31+L2*2); CHR$(33+L1); "."; ELSE PRINT CHR$(16); CHR$(33+L1); CHR$(31+L2*2); "+"; CHR$(8); "."; ENDIF 560 IF RM=1 AND R3=INT(L1) AND R4=INT(L2) THEN GOSUB 9009GOSUB 9017GOTO 9015ENDIF 570 IF Q(L1,L2)=0 THEN 540GOSUB 9009580 IF INT(L1)=B6 AND INT(L2)=B7 THEN GOSUB 9014Q(L1,L2)=0GOSUB 1350GOTO 140ENDIF 590 IF RND(0)<.85 THEN 700600 PRINT "Torpedo failed to detonate."610 IF Q(L1,L2)<>2 THEN GOTO 9015ENDIF 620 PRINT "Klingon has taken evasive" \ PRINT "action."GOSUB 2720Q(L1,L2)=0630 FOR I=1 TO 8640 IF FIX(L1)=KL(I,1) AND FIX(L2)=KL(I,2) THEN 660650 NEXT I660 L1=INT(RND(0)*8)+1L2=INT(RND(0)*8)+1670 IF Q(L1,L2)<>0 OR L1=KL(I,1) AND L2=KL(I,2) THEN 660680 KL(I,1)=L1KL(I,2)=L2Q(L1,L2)=2690 GOTO 290700 IF Q(L1,L2)<>2 THEN 760GOSUB 9016720 IF K9<=0 THEN 1450730 FOR I=1 TO 9740 IF FIX(L1)=KL(I,1) AND FIX(L2)=KL(I,2) THEN KL(I,3)=0ENDIF 750 NEXT IGOTO 860760 IF Q(L1,L2)<>4 THEN 800770 IF RND(0)<.1 THEN PRINT CHR$(cs)PRINT "Torpedo triggered a Supernova!"GOSUB 2720GOTO 1390ENDIF PRINT "Star destroyed."780 S3=S3-1790 GOTO 860800 IF Q(L1,L2)<>5 THEN 820810 TH=TH-1Q(L1,L2)=0PRINT "** Tholian destroyed! **"GOTO 870820 IF Q(L1,L2)<>6 THEN 840830 PRINT "Torpedo is caught in Web."GOTO 9015840 IF Q(L1,L2)<>3 THEN 860PRINT "** Starbase destroyed--" \ PRINT "Congratulations! **"850 B3=B3-1860 Q(L1,L2)=0G(Q1,Q2)=K3*100+B3*10+S3870 GOSUB 1350GOTO 140880 IF T<T0+10 THEN PRINT "THE DEATH RAY IS EXPERIMENTAL."PRINT "IT MAY NOT BE USED UNTIL "; T0+10GOTO 9015ENDIF 890 I=RND(6)900 ON I GOTO 930,910,920,910,930,950910 FOR I=1 TO 3PRINT "Warning:"GOSUB 2720NEXT IPRINT "Death ray malfunctioning."GOSUB 2720GOTO 890920 PRINT "** Spontaneous emissions," \ PRINT "directive cancelled **"GOTO 9015930 PRINT ">>> EMERGENCY <<<"GOSUB 2720940 PRINT "Anti-Stokes decay is leading to thermal degradation."GOSUB 2720GOTO 1390950 PRINT "Energy transfer successful."GOSUB 2720960 IF RM=1 THEN GOSUB 9017GOSUB 2720ENDIF 970 FOR I=1 TO 9980 IF KL(I,3)=0 THEN 1010GOSUB 9016990 PRINT "Sector "; KL(I,1); "-"; KL(I,2)Q(KL(I,1),KL(I,2))=0KL(I,3)=01010 NEXT I1020 G(Q1,Q2)=B3*10+S31030 IF TH<1 THEN 10701040 FOR I=1 TO 8FOR J=1 TO 8IF Q(I,J)=5 THEN Q(I,J)=0ENDIF NEXT JNEXT I1050 PRINT "** Tholians destroyed! **"GOSUB 27201060 TH=0T1=-11070 IF K9<=0 THEN 1450GOTO 1401080 IF R(3)<>0 THEN PRINT "** Long Range Sensors out **"GOTO 140ENDIF 1090 PRINT CHR$(cs); 1100 PRINT " ** Long Range Sensor Scan **"GOSUB 90031110 Q3=Q2-1Q4=Q2+1IF Q3=0 THEN Q3=8ELSE IF Q4=9 THEN Q4=1ENDIF ENDIF 1120 PRINT USING "x6,s1,3(x2,i4,x1,s1)"; "!",Q3,"!",Q2,"!",Q4,"!"1130 PRINT A6$K=Q1+7-INT((Q1+6)/8)*81140 GOSUB 12201160 IF Q1=1 THEN PRINT A6$ENDIF K=Q1+8-INT((Q1+7)/8)*81170 PRINT USING "i3>,x3,s1,x1,i4^,x2,s1,x2,s3,x2,s1,x1,i4^,x2,s1"
; K,"!",G(K,Q3),"!"," E ","!",G(K,Q4),"!"1180 PRINT A6$1190 IF Q1=8 THEN PRINT A6$ENDIF K=Q1+9-INT((Q1+8)/8)*8GOSUB 1220GOSUB 1350GOTO 1401220 PRINT USING "i3>,x3,s1,3(x1,i4^,x2,s1)"; K,"!",G(K,Q3),"!",
G(K,Q2),"!",G(K,Q4),"!"PRINT A6$RETURN 1240 IF C$="DOCKED" THEN PRINT "Starbase shields protect the" \ PRINT "Enterprise."GOSUB 2720RETURN ENDIF 1250 FOR I=1 TO 91260 IF KL(I,3)<=0 THEN 13401270 D=ABS(KL(I,1)-S1)^2+ABS(KL(I,2)-S2)^21280 D=SQRT(D)+.51290 H=INT(KL(I,3)*(RND(0)*.75+.25)/D)1300 H=H*lv \E=E-H1310 GOSUB 9013PRINT "Enterprise" \ PRINT "from Klingon at "; KL(I,1); "-"; KL(
I,2)1320 IF E<300 THEN PRINT USING "'(',i4>"; E;  \ PRINT " units left )"ENDIF 1340 NEXT IRETURN 1350 IF K3>0 THEN GOSUB 1240ENDIF 1360 IF RM=1 THEN GOSUB 2650ENDIF 1370 IF TH>1 THEN GOSUB 2450ENDIF 1380 IF E>0 AND T<T9 THEN RETURN ENDIF 1390 PRINT CHR$(cs); TAB(cs); "STAR TREK"PRINT A6$PRINT "It is now stardate "; T1400 IF T>T9 THEN PRINT "The Enterprise has failed to" \ PRINT "complete its mission in time."ELSE IF E<0 THEN PRINT "The Enterprise is out of energy and adrift in space."ELSE PRINT "The Enterprise has been" \ PRINT "destroyed."ENDIF ENDIF 1410 PRINT "The Federation will be" \ PRINT "conquered."1420 IF K9=1 THEN PRINT "One Klingon ship remains."ELSE PRINT "There are still "; K9; " Klingon" \ PRINT "battle cruisers left."ENDIF 1430 IF T>T9 THEN PRINT "You have been demoted to acting Ensign."ELSE PRINT "You are dead!!"ENDIF PRINT A6$1440 GOTO 15101450 PRINT CHR$(cs); TAB(cs); "STAR TREK"1460 PRINT A6$ \ PRINT "It is stardate "; T \ PRINT "The last Klingon battle"1470 PRINT "cruiser in the galaxy has been" \ PRINT "destroyed."1480 J=T-T0IF J<1 THEN J=1ENDIF IF R3<>-1 THEN R3=0ENDIF IF B4<>-1 THEN B4=0ENDIF IF T1<>-1 THEN T1=0ENDIF 1490 I=K0*1000/J-R3*250-B4*100-T1*999-DD=0IF I>1000 THEN PRINT "You have been promoted to" \ PRINT "admiral!"ELSE PRINT "You have won the Federation's" \ PRINT "Highest award for bravery."ENDIF 1500 PRINT K0; " Klingons in";  \ PRINT USING "i3"; J;  \ PRINT " years."PRINT "RATING =";  \ PRINT USING "i8"; IPRINT A6$1510 INPUT "Another Game? ",A$1520 IF A$="Y" OR A$="y" THEN 100END 1530 GOSUB 9009 \ INPUT "COURSE (1-8.9999)? ",C11540 IF C1=0 THEN 1401550 IF C1<0 OR C1>8.9999 THEN 15301560 INPUT "WARP FACTOR (0-12)? ",W11570 IF W1=0 THEN 1401580 IF W1<0 OR W1>12 THEN 15601590 IF W1>.2 AND R(1)<0 THEN PRINT CHR$(7)PRINT "Warp engines are damaged," \ PRINT "maximum speed = Warp .2"GOTO 1560ENDIF 1600 IF K3>0 OR TH>0 THEN GOSUB 1240IF E<=0 THEN 1390ENDIF 1610 IF W1>=1 THEN GOSUB 1620GOTO 1660ELSE GOTO 1660ENDIF 1620 FOR I=1 TO 61630 IF R(I)=-1 THEN PRINT "** "; A2$(I); " now fully" \ PRINT "repaired **" \ GOSUB 2720ENDIF 1640 IF R(I)<0 THEN R(I)=R(I)+1ENDIF IF R(I)>0 THEN R(I)=0ENDIF 1650 NEXT IRETURN 1660 IF RND(0)<.95 THEN 17801670 PRINT CHR$(cs)PRINT "You have been accelerated by a" \ PRINT "BLACK HOLE into another time"
 \ PRINT "and space in the galaxy."1680 L1=INT(RND(0)*8)+1L2=INT(RND(0)*8)+1IF L1=Q1 AND L2=Q2 THEN 16801690 Q1=L1Q2=L21700 K=RND(10)-5IF K=0 THEN 17001710 T=INT(T+K)IF T>T9 THEN 13901720 PRINT "It is now stardate "; T \ PRINT "The Enterprise is now in"GOSUB 9003 \ GOSUB 9004GOSUB 2720 \ GOSUB 27201730 FOR I=1 TO 81740 FOR J=1 TO 81750 Q(I,J)=01760 NEXT JNEXT I1770 Q1=-1GOTO 23801780 IF RND(0)>.25 THEN 19701790 R1=INT(RND(0)*6)+11800 IF RND(0)>.5 THEN 18401810 R(R1)=R(R1)-RND(5)1820 PRINT "** Space storm, "; A2$(R1) \ PRINT "damaged **"1830 GOSUB 2720GOTO 19701840 FOR I=R1 TO 51850 IF R(I)<0 THEN 19201860 NEXT I1870 J=R1-11880 FOR I=1 TO J1890 IF R(I)<0 THEN 19201900 NEXT I1910 GOTO 19701920 R1=I1930 R(I)=R(I)+RND(5)1940 IF R(I)>0 THEN R(I)=0ENDIF 1950 IF R(I)=0 THEN PRINT "Truce, "; A2$(I) \ PRINT "now fully repaired."ELSE PRINT "Truce, "; A2$(I) \ PRINT "state of repair improved."ENDIF 1960 GOSUB 27201970 J=W1*8E=E-2*JIF W1>=1 THEN T=T+1ENDIF 1980 IF T>T9 OR E<=0 THEN 13901990 IF J=0 THEN 2902000 Q(S1,S2)=0X=S1Y=S22010 X1=-(SIN((C1-1)*.785398))X2=COS((C1-1)*.785398)2020 IF ABS(X1)>ABS(X2) THEN XY=ABS(X1)ELSE XY=ABS(X2)ENDIF 2030 J=J*XY+.52040 FOR I=1 TO J2050 X=X+X1/XYY=Y+X2/XY2060 IF X<.5 OR X>8.5 OR Y<.5 OR Y>8.5 THEN 2310L1=INT(X+.5)L2=INT(Y+.5)2070 IF Q(L1,L2)<>0 THEN 21102080 S1=INT(L1)S2=INT(L2)2090 NEXT I2100 Q(S1,S2)=1GOTO 2902110 K=Q(L1,L2)PRINT "The Enterprise has collided" \ PRINT "with a "; ON K GOTO 2120,2120,2210,2250,2230,22402120 PRINT "Klingon battle cruiser." \ PRINT "The Klingon has been destroyed"2140 FOR K=1 TO 92150 IF KL(K,1)=L1 AND KL(K,2)=L2 THEN 21702160 NEXT K2170 E=E-KL(K,3)2180 KL(K,3)=0K3=K3-1K9=K9-12190 IF K9<=0 THEN 14502200 Q(L1,L2)=1S1=INT(L1)S2=INT(L2)GOTO 22702210 PRINT "Starbase."2220 Q(S1,S2)=1GOTO 22702230 PRINT "Tholian."Q(S1,S2)=1GOTO 22702240 PRINT "Tholian Web."Q(S1,S2)=1GOTO 22702250 PRINT "Star."2260 Q(S1,S2)=12270 GOSUB 2720R1=INT(RND(0)*6)+12280 K=J-I+1IF K>5 THEN K=5ENDIF 2290 R(R1)=R(R1)-K2300 PRINT "** "; A2$(R1); " damaged" \ PRINT "by collision **"GOSUB 2720GOTO 2902310 IF W1<1 THEN W1=1T=T+1GOSUB 1620ENDIF 2320 X=Q1+W1*X1/XY2330 L1=INT(X+.5)-12340 IF L1<0 AND L1>-9 THEN L1=9+L1ELSE L1=ABS((L1/8-INT(L1/8))*8)+1ENDIF 2350 X=Q2+W1*X2/XY2360 L2=INT(X+.5)-12370 IF L2<0 AND L2>-9 THEN L2=9+L2ELSE L2=ABS((L2/8-INT(L2/8))*8)+1ENDIF 2380 Q1=L1Q2=L2S1=INT(RND(0)*8)+1S2=INT(RND(0)*8)+12390 GOTO 1702400 PRINT CHR$(cs)PRINT "SELF-DESTRUCT SEQUENCE INITIATED"FOR temp=10 TO 8 STEP -1 \ GOSUB 2730 \NEXT tempPRINT "1ST OFFICER SPOCK ENTERS CODE."GOSUB 2720PRINT "*** CODE VERIFIED ***"FOR temp=7 TO 4 STEP -1 \ GOSUB 2730 \NEXT tempINPUT "ENTER SECRET CODE: ",A$IF A$<>CO$ THEN I=15GOTO 140ENDIF PRINT "*** CODE VERIFIED ***"FOR temp=3 TO 1 STEP -1 \ GOSUB 2730 \NEXT tempPRINT "* SELF-DESTRUCT ACTIVATED *"GOSUB 27202410 PRINT CHR$(cs)PRINT "THE ENTROPY OF THE UNIVERSE HAS BEEN MAXIMIZED."GOSUB 2720K9=K9-RND(K9)D=500IF K9<1 THEN PRINT CHR$(cs)PRINT "YOU ARE DEAD."GOTO 1460ENDIF 2430 GOTO 13902440 PRINT CHR$(cs)PRINT "** CODE VERIFICATION FAILS . . . SELF-DESTRUCT ABORTED **"GOSUB 2720GOTO 1402450 IF B3<>0 THEN 24702460 IF C$="DOCKED" THEN PRINT "STARBASE SHIELDS PROTECT THE ENTERPRISE"RETURN ENDIF 2470 PRINT "Tholians attack Enterprise"2480 X=0L=02490 FOR I=-1 TO 12500 FOR J=-1 TO 12510 IF S1+J<1 OR S1+J>8 OR S2+I<1 OR S2+I>8 THEN L=L+1GOTO 2530ENDIF 2520 IF Q(S1+J,S2+I)=0 THEN X=X+1ENDIF 2530 NEXT JNEXT I2540 FOR I=1 TO TH2550 WB=WB+270-20*(INT(RND(0)*4)+1)2560 IF X=0 THEN GOSUB 280Q(R1,R2)=6GOTO 2600ENDIF 2570 R1=S1-2+INT(RND(0)*3)+1R2=S2-2+INT(RND(0)*3)+12580 IF R1<1 OR R1>8 OR R2<1 OR R2>8 THEN 2570IF Q(R1,R2)<>0 THEN 25702590 Q(R1,R2)=6X=X-12600 NEXT I2610 X=(8-L-X)/8*1002620 PRINT "** Web is "; X; " % complete. **"2630 IF X>99 THEN PRINT "The Enterprise has been" \ PRINT "trapped!"GOSUB 2720GOTO 1390ENDIF 2640 GOSUB 2720RETURN 2650 H=INT(120*(RND(0)*.75+.25))E=E-HPRINT CHR$(7)GOSUB 9013 \ PRINT "Enterprise"PRINT USING "'from Romulan at',i3,'-',i3"; R3,R42660 PRINT "** Romulan ship has re-engaged" \ PRINT "its cloaking device **"GOSUB 27202670 IF RND(0)>.5 THEN RETURN ENDIF 2680 R1=R3+INT(RND(0)*3)-1IF R1>8 OR R1<1 THEN 26802690 R2=R4+INT(RND(0)*3)-1IF R2>8 OR R2<1 THEN 26902700 R3=R1R4=R22710 RETURN 2720 FOR ZZ=1 TO 2000NEXT ZZRETURN 2730 PRINT USING "I3>"; tempPRINT CHR$(7)FOR ZZ=1 TO 800 \NEXT ZZRETURN RETURN 9001 PRINT USING "s10,i5"; " Stardate=",T \ RETURN 9002 PRINT USING "s8,s6"; " Status=",C$ \ RETURN 9003 PRINT USING "s10,i2,s1,i2<"; " Quadrant=",Q1,"-",Q2 \ RETURN
9004 PRINT USING "s10,i2,s1,i2<"; " Sector=",S1,"-",S2 \ RETURN 9005 PRINT USING "s10,i5"; " Energy=",E \ RETURN 9006 PRINT USING "s10,i5"; " Phot.Tp=",P \ RETURN 9007 PRINT USING "s10,i5"; " Klingons=",K9 \ RETURN 9008 PRINT USING "s10,i5"; " Yrs Left=",K \ RETURN 9009 IF cs=12 THEN 9010 PRINT CHR$(2); CHR$(32); CHR$(43); 9011 FOR temp=1 TO 4 \ PRINT CHR$(3) \NEXT temp9012 PRINT CHR$(2); CHR$(32); CHR$(43); ELSE PRINT CHR$(16); CHR$(43); CHR$(32); CHR$(23); CHR$(0); ENDIF RETURN 9013 PRINT USING "i5>"; H;  \ PRINT " unit hit on ";  \ RETURN 9014 PRINT "Klingon mine destroyed!"B4=-1B6=-1G(Q1,Q2)=G(Q1,Q2)-10RETURN 9015 GOSUB 2720 \ GOSUB 1350 \ GOTO 1409016 PRINT "** Klingon destroyed! **"K3=K3-1K9=K9-1IF K3=0 THEN C$="GREEN" \ ENDIF RETURN 9017 PRINT "** Romulan destroyed! **"RM=0R3=-1RETURN 9018 PRINT "Offensive weapons" \ PRINT "may not be used while docked."GOTO 140GOTO 140