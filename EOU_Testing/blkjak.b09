PROCEDURE blkjakTYPE c=cards(52),cardnumber:INTEGERDIM deck:cTYPE dealer=ccount,acecount,showcard:INTEGER; bjack:BOOLEAN; holecard$ :STRING[20]TYPE player=ccnt,acecnt,card1,card2,doublecount(3):INTEGER; bj:BOOLEAN ; name$,card$(3):STRING[20]DIM d:dealer; p:playerDIM balance,startbalance,wager,i,temp,bet(3):INTEGERDIM card:STRING[20]; reply:STRING[1]DIM score:REALtemp=RND(-(VAL(RIGHT$(DATE$,2))))FOR i=1 TO 52deck.cards(i)=i-1NEXT ideck.cardnumber=52PRINT PRINT "***** Las Vegas Blackjack *****"PRINT REPEAT INPUT "What is your name? ",p.name$p.name$=TRIM$(p.name$)UNTIL p.name$<>""IF LEFT$(p.name$,1)>="a" AND LEFT$(p.name$,1)<"z" THEN p.name$=CHR$(ASC(p.name$)-$20)+MID$(p.name$,2,255)ENDIF LOOP INPUT "Do you want a list of the rules (y/n)?",replyRUN upper(reply)IF reply<>"N" THEN PRINT PRINT "The rules of this casino are" \ PRINT "as follows..."PRINT "BlackJack pays 3 to 2."PRINT "Pairs may be split."PRINT "You only get one card on each" \ PRINT "split ace."PRINT "You may double down on a" \ PRINT "split pair."PRINT "You do not lose a tie hand."PRINT "Dealer hits 16" \ PRINT "Dealer stands on all 17's."PRINT "Wagers are 1 to 500 dollars."PRINT "Type Enter to draw a card."PRINT "Type S     to stand."PRINT "type D     to double down."PRINT "Type X     to split your pairs."PRINT "Bet 0 dollars to end a game."PRINT "* Good Luck *"ENDIF PRINT PRINT "This game started at "; RIGHT$(DATE$,8)startbalance=RND(1000)+50balance=startbalancePRINT "Your bankroll for this game is  "; balance; " dollars."LOOP IF deck.cardnumber>=49 THEN RUN shuffle(deck)ENDIF PRINT LOOP INPUT "Wager? ",wagerEXITIF wager>=0 AND wager<=500 THEN ENDEXIT PRINT "House limits are between 1 and 500 dollars."ENDLOOP IF wager<>0 THEN p.ccnt=0 \p.acecnt=0d.ccount=0 \d.acecount=0RUN Draw(deck,p.ccnt,p.acecnt,p.card1,p.card$(1))RUN Draw(deck,d.ccount,d.acecount,d.showcard,card)PRINT "Dealer shows:" \ PRINT cardRUN Draw(deck,p.ccnt,p.acecnt,p.card2,p.card$(2))PRINT p.name$; " has: " \ PRINT p.card$(1); "," \ PRINT p.card$( 2)RUN Draw(deck,d.ccount,d.acecount,temp,d.holecard$)p.bj=p.ccnt=21d.bjack=d.ccount=21IF d.showcard=11 THEN RUN ibet(d,p,balance,wager)ENDIF IF d.bjack THEN PRINT "dealer has BlackJack."ELSE LOOP INPUT replyRUN upper(reply)EXITIF p.card1=p.card2 AND reply="X" THEN ENDEXIT EXITIF SUBSTR(reply,"SD")<>0 THEN ENDEXIT PRINT "Invalid request--retry."ENDLOOP IF reply="" OR reply="D" THEN RUN playermove(deck,p,reply,wager,p.ccnt)p.bj=FALSEENDIF IF reply="X" THEN FOR i=1 TO 2bet(i)=wagerp.doublecount(i)=p.card1IF p.card1=11 THEN p.acecnt=1ENDIF RUN Draw(deck,p.doublecount(i),p.acecnt,temp,card)PRINT "Hand #"; i \ PRINT p.card$(i); "," \ PRINT cardIF p.card1<>11 THEN LOOP INPUT replyRUN upper(reply)EXITIF SUBSTR(reply,"SD")<>0 THEN ENDEXIT PRINT "Invalid request--retry."ENDLOOP ENDIF RUN playermove(deck,p,reply,bet(i),p.doublecount(i))NEXT iRUN dealermove(deck,d,p)FOR i=1 TO 2PRINT "Hand #"; iRUN winloss(d,p,p.doublecount(i),bet(i),balance)NEXT iENDIF ENDIF IF reply<>"X" THEN IF p.bj THEN PRINT p.name$; " has BlackJack."wager=1.5*wagerENDIF RUN dealermove(deck,d,p)RUN winloss(d,p,p.ccnt,wager,balance)ENDIF ENDIF EXITIF wager=0 THEN ENDEXIT ENDLOOP IF balance<0 THEN PRINT p.name$; " owes the casino " \ PRINT -(balance); " dollars."ENDIF score=balance-startbalanceINPUT "New Game (Y/N)? ",replyRUN upper(reply)EXITIF reply="N" THEN ENDEXIT ENDLOOP END PROCEDURE dealermoveTYPE c=cards(52),cardnumber:INTEGERTYPE dealer=ccount,acecount,showcard:INTEGER; bjack:BOOLEAN; holecard$ :STRING[20]TYPE player=ccnt,acecnt,card1,card2,doublecount(3):INTEGER; bj:BOOLEAN ; name$,card$(3):STRING[20]PARAM deck:c; d:dealer; p:playerDIM temp:INTEGER; card:STRING[20]PRINT "Dealer hole card:" \ PRINT d.holecard$WHILE d.ccount<17 AND NOT(p.bj) AND p.ccnt<=21 DO RUN Draw(deck,d.ccount,d.acecount,temp,card)PRINT "Dealer hits: "; cardENDWHILE IF d.ccount>21 THEN PRINT "Dealer busts."ENDIF END PROCEDURE winlossTYPE dealer=ccount,acecount,showcard:INTEGER; bjack:BOOLEAN; holecard$ :STRING[20]TYPE player=ccnt,acecnt,card1,card2,doublecount(3):INTEGER; bj:BOOLEAN ; name$,card$(3):STRING[20]PARAM d:dealer; p:player; count,wager,balance:INTEGERIF NOT(p.bj) AND NOT(d.bjack) AND count<=21 AND d.ccount<=21 THEN PRINT p.name$; "'s count= "; count \ PRINT "Dealer's count= "; d.ccountENDIF IF d.bjack AND NOT(p.bj) OR count>21 OR count<d.ccount AND d.ccount <22 THEN balance=balance-wagerPRINT "Dealer wins this hand." \ PRINT "Bankroll= "; balance; " dollars."ELSE IF count=d.ccount AND count<22 THEN PRINT "This hand is a tie." \ PRINT "Bankroll= "; balance; " dollars."ELSE balance=balance+wagerPRINT p.name$; " wins this hand." \ PRINT "Bankroll= "; balance; " dollars."ENDIF ENDIF END PROCEDURE playermoveTYPE c=cards(52),cardnumber:INTEGERTYPE player=ccnt,acecnt,card1,card2,doublecount(3):INTEGER; bj:BOOLEAN ; name$,card$(3):STRING[20]PARAM deck:c; p:player; reply:STRING[1]; wager,count:INTEGERDIM temp:INTEGER; card:STRING[20]IF reply="D" THEN RUN Draw(deck,count,p.acecnt,temp,card)wager=2*wagerPRINT p.name$; " doubles down:" \ PRINT cardIF count>22 THEN PRINT p.name$; " busts."ENDIF END ENDIF REPEAT RUN Draw(deck,count,p.acecnt,temp,card)PRINT p.name$; " hits:" \ PRINT cardIF count>21 THEN PRINT p.name$; " busts."END ENDIF LOOP INPUT replyRUN upper(reply)EXITIF SUBSTR(reply,"S")<>0 THEN ENDEXIT PRINT "Invalid request--retry."ENDLOOP UNTIL reply="S"END PROCEDURE ibetTYPE dealer=ccount,acecount,showcard:INTEGER; bjack:BOOLEAN; holecard$ :STRING[20]TYPE player=ccnt,acecnt,card1,card2,doublecount(3):INTEGER; bj:BOOLEAN ; name$,card$(3):STRING[20]PARAM d:dealer; p:player; balance,wager:INTEGERDIM reply:STRING[1]LOOP INPUT "Insurance bet (Y or N)? ",replyRUN upper(reply)EXITIF SUBSTR(reply,"YN")<>0 THEN ENDEXIT ENDLOOP IF d.bjack THEN IF reply="Y" THEN balance=balance+wagerPRINT p.name$; " wins insurance bet of" \ PRINT wager; " dollars."ENDIF ELSE IF reply="Y" THEN balance=balance-.5*wagerPRINT "Dealer does not have BlackJack."PRINT p.name$; " loses insurance bet of "; .5*wager; " dollars."ENDIF PRINT "Hand continues;" \ PRINT "enter requests as usual."ENDIF END PROCEDURE drawTYPE d=cards(52),cardnumber:INTEGERPARAM deck:d; ccount,acecount,cardvalue:INTEGERPARAM card$:STRING[20]DIM r,s:INTEGERIF deck.cardnumber>=52 THEN RUN shuffle(deck)ENDIF cardvalue=deck.cards(deck.cardnumber)deck.cardnumber=deck.cardnumber+1s=cardvalue/13r=MOD(cardvalue,13)cardvalue=r+1IF cardvalue>10 THEN cardvalue=10ENDIF IF cardvalue=1 THEN cardvalue=11ENDIF FOR i=0 TO rREAD rank$NEXT iRESTORE 100FOR i=0 TO sREAD suit$NEXT icard$=rank$+" of "+suit$ccount=ccount+cardvalueIF cardvalue=11 THEN acecount=acecount+1 \ ENDIF WHILE ccount>21 AND acecount>0 DO acecount=acecount-1ccount=ccount-10ENDWHILE END DATA "Ace","Two","Three","Four"DATA "Five","Six","Seven","Eight"DATA "Nine","Ten","Jack","Queen","King"100 DATA "Spades","Hearts","Clubs","Diamonds"PROCEDURE shuffleTYPE d=cards(52),cardnumber:INTEGERPARAM deck:dDIM i,j,delay,temp:INTEGERPRINT "** Dealer Reshuffles **"FOR delay=1 TO INT(RND(10))+1FOR i=1 TO 52j=RND(51)+1temp=deck.cards(i)deck.cards(i)=deck.cards(j)deck.cards(j)=tempNEXT iNEXT delaydeck.cardnumber=1END PROCEDURE upperPARAM reply:STRING[1]IF reply<>"" AND reply>"Z" THEN reply=CHR$(ASC(reply)-$20)ENDIF END 