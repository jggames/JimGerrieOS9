PROCEDURE Galisat2BASE 0DIM dt,dl,n,p,mt,mj,vt,vj,k,jj,z,j,s:REALDIM i,f,f1,u1,u2,u3,u4,pie,d1,j1:REALDIM x1,x2,x3,x4:REALDIM xx1,xx2,xx3,xx4:INTEGERDIM v,v1:REALDIM l,d,day,m,y,g,zz,vv,vv1,mm(13):INTEGERDIM ll,r,key:STRING[4]DIM month$(13):STRING[8]FOR zz=1 TO 12READ month$(zz)NEXT zzRUN GFX2("COLOR",4,2,2)PRINT CHR$(12); PRINT "Are you using a (T)elescope or"PRINT "(B)inoculars? "; key=""WHILE key<>"t" AND key<>"T" AND key<>"b" AND key<>"B" DO RUN INKEY(key)ENDWHILE IF key="t" OR key="T" THEN l=1ll="West"r="East"ENDIF IF key="b" OR key="B" THEN l=-1ll="East"r="West"ENDIF REM =====REM MainREM =====key=""WHILE key<>"q" AND key<>"Q" DO 24 RUN GFX2("COLOR",4,2,2) \ PRINT CHR$(12); RUN LOCATE(13,0)PRINT "* GALISAT 3 *"RUN LOCATE(13,2)PRINT "CoCo 3 Version"RUN LOCATE(12,3)PRINT "by David Francis"RUN LOCATE(5,4)PRINT "OS-9 Vesion by Jim Gerrie"RUN LOCATE(1,6)PRINT "Plots positions of Jupiter's Galilean   satellites"28 GOSUB 6000 \REM Initialize30 GOSUB 2000 \REM Get DateRUN GFX2("CUROFF")34 GOSUB 5000 \REM Setup Plot Screen35 GOSUB 1000 \REM Main Program LoopRUN GFX2("CURON")ENDWHILE RUN GFX2("COLOR",0,2,2)RUN GFX2("CURON")END 36 REM ========================38 REM Main Program Loop40 REM ========================1000 dl=INT((n-INT(n))*20+.5)/20mt=(358.476+.9856003*n)*pmj=(225.328+.0830853*n)*pjj=221.647+.9025179*n1002 vt=1.92*SIN(mt)+.02*SIN(2*mt)vj=5.55*SIN(mj)+.17*SIN(2*mj)k=(jj+vt-vj)*pdt=SQRT(28.07-10.406*COS(k))1004 z=SIN(k)/dti=ATN(z/SQRT(1-z*z))i=i/pf=n-dt/173f1=i-vj1006 u1=84.5506+203.405863*f+f1u2=41.5015+101.291632*f+f1u3=109.977+50.2345169*f+f1u4=176.3586+21.4879802*f+f11008 x1=5.906*SIN(u1*p+pie)x1=139+l*INT(x1*3.5+.5)x2=9.397*SIN(u2*p+pie)x2=139+l*INT(x2*3.5+.5)1010 x3=14.989*SIN(u3*p+pie)x3=139+l*INT(x3*3.5+.5)x4=26.364*SIN(u4*p+pie)x4=139+l*INT(x4*3.5+.5)1012 RUN GFX2("COLOR",4)1014 GOSUB 6020RUN GFX2("POINT",xx1,vv1)RUN GFX2("POINT",xx2,vv1)RUN GFX2("POINT",xx3,vv1)RUN GFX2("POINT",xx4,vv1)1016 RUN GFX2("POINT",xx1,vv)RUN GFX2("POINT",xx2,vv)RUN GFX2("POINT",xx3,vv)RUN GFX2("POINT",xx4,vv)RUN INKEY(key)IF key=" " THEN RUN LOCATE(32,23)key=""WHILE key="" DO RUN INKEY(key)ENDWHILE ELSE FOR zz=1 TO 1000NEXT zzENDIF IF key=CHR$(13) OR key="q" OR key="Q" THEN 10211018 RUN GFX2("COLOR",2)RUN GFX2("POINT",xx1,vv1)RUN GFX2("POINT",xx2,vv1)RUN GFX2("POINT",xx3,vv1)RUN GFX2("POINT",xx4,vv1)RUN GFX2("COLOR",4)RUN GFX2("LINE",272,180,284,180)v=v+1n=n+.05IF v<>170 THEN 10001020 RUN INKEY(key)IF key<>CHR$(13) AND key<>"q" AND key<>"Q" THEN 10201021 RETURN 1022 REM ========================1024 REM Get date & convert it to1026 REM Julian day no.1028 REM ========================2000 RUN LOCATE(1,10) \ INPUT " Enter YEAR (YYYY) ",yRUN LOCATE(1,11)INPUT " Enter MONTH  (MM) ",mRUN LOCATE(1,12)INPUT " Enter DAY    (DD) ",d2002 g=0GOSUB 3000 \REM Date Valid?IF g=1 THEN 20002006 d1=INT(d)f=d-d1-.52008 j=-(INT(7*(INT((m+9)/12)+y)/4))2010 REM 2012 s=SGN(m-9)a=ABS(m-9)2014 j1=INT(y+s*INT(a/7))2016 j1=-(INT((INT(j1/100)+1)*3/4))2018 j=j+INT(275*m/9)+d1+1*j12020 j=j+1721027.+2*1+367*y2022 IF f>=0 THEN 20262024 f=f+1j=j-12026 n=j-2415020.+fday=d2028 RETURN 2030 REM =====================2032 REM Check for valid date2034 REM =====================3000 IF y<0 OR y>32766 THEN PRINT PRINT " YEAR must be 0 - 32766."GOTO 3006ENDIF 3002 IF m<1 OR m>12 THEN PRINT PRINT " MONTH is invalid.      "GOTO 3006ENDIF RUN DaysInMonths(mm)RUN SetDateInfo(y,mm)3004 IF d<1 OR d>mm(m) THEN PRINT PRINT " DAY is invalid.        "GOTO 3006ENDIF GOTO 30083006 g=13008 RETURN 4002 REM ==================4004 REM Setup Plot Screen4006 REM ==================5000 RUN GFX2("CLEAR")RUN GFX2("COLOR",4)RUN GFX2("BOX",500,0,639,191)RUN GFX2("COLOR",4)RUN GFX2("FILL",504,1)5002 RUN GFX2("LINE",272,0,272,170)RUN GFX2("LINE",284,0,284,170)5004 FOR zz=2 TO 170 STEP 20RUN GFX2("LINE",0,zz,30,zz)RUN GFX2("LINE",470,zz,500,zz)NEXT zzFOR zz=0 TO 23 STEP 5RUN LOCATE(2,zz)PRINT dayday=day+2IF day=mm(m)+2 THEN day=2ENDIF IF day=mm(m)+1 THEN day=1ENDIF NEXT zzRUN GFX2("COLOR",4)5006 RUN GFX2("CIRCLE",278,180,6)RUN GFX2("FILL",278,180)RUN GFX2("LINE",0,170,500,170)RUN LOCATE(0,23)PRINT ll; RUN LOCATE(27,23)PRINT r; RUN GFX2("COLOR",2,4,2)5008 RUN LOCATE(32,1)PRINT "Plot"RUN LOCATE(32,2)PRINT "begins"RUN LOCATE(32,3)PRINT "on"RUN LOCATE(32,4)PRINT month$(m)RUN LOCATE(32,5)PRINT STR$(d)+","RUN LOCATE(32,6)PRINT STR$(y)+"."RUN LOCATE(32,9)PRINT "Dashes"RUN LOCATE(32,10)PRINT "indicate"RUN LOCATE(32,11)PRINT "midnight"RUN LOCATE(32,12)PRINT "EST on"RUN LOCATE(32,13)PRINT "dates"RUN LOCATE(32,14)PRINT "shown."5012 RUN LOCATE(32,18)PRINT "[ENTER]="RUN LOCATE(32,19)PRINT "New Plot"RUN LOCATE(32,22)PRINT "[Q]=End"RUN LOCATE(32,20)PRINT "[SPACE]="RUN LOCATE(32,21)PRINT "Pause"; RUN GFX2("COLOR",4)RETURN 5014 REM ======================5016 REM Initialize5018 REM ======================6000 dt=0dl=0mt=0mj=0vt=0vj=0k=0jj=0z=0j=0s=0y=0m=0d=0i=0f=0f1=0u1=0u2=0u3=0u4=0pie=3.14159265p=pie/180d1=0j1=0x1=0x2=0x3=0x4=0xx1=0xx2=0xx3=0xx4=0v=0v1=180zz=0vv1=06006 RETURN 6020 xx1=INT(x1)*2xx2=INT(x2)*2xx3=INT(x3)*2xx4=INT(x4)*2xx1=INT(x1)*2vv1=INT(v1)vv=INT(v)RETURN 7000 DATA "January","February","March","April"DATA "May","June","July","August"DATA "Sept.","October","November","December"PROCEDURE LocatePARAM A,B:INTEGERRUN GFX2("CURXY",A,B)END PROCEDURE DaysInMonthsBASE 0PARAM mm(13):INTEGERDIM i:INTEGERDATA 31,28,31,30DATA 31,30,31,31DATA 30,31,30,31FOR i=1 TO 12READ mm(i)NEXT iEND PROCEDURE Jan1PARAM year:INTEGERPARAM day:INTEGERday=year+4+(year+3)/4IF year>1800 THEN day=day-(year-1701)/100day=day+(year-1601)/400ENDIF IF year>1752 THEN day=day+3ENDIF day=MOD(day,7)END PROCEDURE SetDateInfoBASE 0PARAM Year:INTEGERPARAM mm(13):INTEGERDIM leap,work,first:INTEGERRUN Jan1(Year,first)RUN Jan1(Year+1,work)leap=MOD(work+7-first,7)IF leap=2 THEN mm(2)=29ELSE IF leap<>1 THEN mm(9)=19ENDIF ENDIF END 